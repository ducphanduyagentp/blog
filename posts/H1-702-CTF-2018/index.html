<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content=""><meta name="hour-prompt" content=""><meta name="minute-prompt" content=""><meta name="justnow-prompt" content=""><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="H1-702 CTF 2018" /><meta name="author" content="Duc Phan" /><meta property="og:locale" content="en_US" /><meta name="description" content="It’s this time of the year again and I have the chance to play the CTF held by Hackerone. It has a lot of mobile hacking challenge, and at the same time, I wanted to dive into this. What a good time to learn!" /><meta property="og:description" content="It’s this time of the year again and I have the chance to play the CTF held by Hackerone. It has a lot of mobile hacking challenge, and at the same time, I wanted to dive into this. What a good time to learn!" /><link rel="canonical" href="https://ret2.life/posts/H1-702-CTF-2018/" /><meta property="og:url" content="https://ret2.life/posts/H1-702-CTF-2018/" /><meta property="og:site_name" content="ret2life" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2018-06-29T20:48:43+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="H1-702 CTF 2018" /><meta name="twitter:site" content="@flyingpassword" /><meta name="twitter:creator" content="@Duc Phan" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Duc Phan"},"dateModified":"2018-06-29T20:48:43+08:00","datePublished":"2018-06-29T20:48:43+08:00","description":"It’s this time of the year again and I have the chance to play the CTF held by Hackerone. It has a lot of mobile hacking challenge, and at the same time, I wanted to dive into this. What a good time to learn!","headline":"H1-702 CTF 2018","mainEntityOfPage":{"@type":"WebPage","@id":"https://ret2.life/posts/H1-702-CTF-2018/"},"url":"https://ret2.life/posts/H1-702-CTF-2018/"}</script><title>H1-702 CTF 2018 | ret2life</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ret2life"><meta name="application-name" content="ret2life"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang=""><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://pbs.twimg.com/profile_images/1417881771534819331/0AuUptMd_400x400.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">ret2life</a></div><div class="site-subtitle font-italic">From CTF write-ups to everyday life kind of things</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span></span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/ducphanduyagentp" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/flyingpassword" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['youreallythingimmaputemail','on.here?'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> </a> </span> <span>H1-702 CTF 2018</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" ></span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>H1-702 CTF 2018</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Duc Phan </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="2018-06-29 20:48:43 +0800" >2018-06-29 20:48:43 +0800<i class="unloaded">2018-06-29T20:48:43+08:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="4048 ">22 </span></div></div><div class="post-content"><p>It’s this time of the year again and I have the chance to play the CTF held by Hackerone. It has a lot of mobile hacking challenge, and at the same time, I wanted to dive into this. What a good time to learn!</p><p>Update 1: I totally forgot the fifth part of the flag in the first challenge while I was writing this. That’s what it’s like rushing a post :)</p><h2 id="mobile-challenge-1">Mobile Challenge 1</h2><p><img data-proofer-ignore data-src="/assets/img/h1702/1.1.png" alt="mobile1" /></p><p>Let’s open up the apk in jadx. The first part of the flag is revealed in the MainActivity: <code class="language-plaintext highlighter-rouge">flag{so_much</code></p><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="o">...</span>
    <span class="kt">void</span> <span class="nf">doSomething</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="s">"Part 1"</span><span class="o">,</span> <span class="s">"The first part of your flag is: \"flag{so_much\""</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>The fourth part is represented in a function in the same package</p><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">com.hackerone.mobile.challenge1</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FourthPart</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="nf">eight</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"w"</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nc">String</span> <span class="nf">five</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"_"</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nc">String</span> <span class="nf">four</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"h"</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nc">String</span> <span class="nf">one</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"m"</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nc">String</span> <span class="nf">seven</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"o"</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nc">String</span> <span class="nf">six</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"w"</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nc">String</span> <span class="nf">three</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"c"</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nc">String</span> <span class="nf">two</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"u"</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>To get the fourth part, we only need to rearrange the characters in the order of the function name and we get <code class="language-plaintext highlighter-rouge">much_wow</code></p><p>The third part is found in the <code class="language-plaintext highlighter-rouge">strings.xml</code> file in the values folder: <code class="language-plaintext highlighter-rouge">analysis_</code></p><div class="language-xml highlighter-rouge"><div class="code-header"> <span text-data=" XML "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;resources&gt;</span>
    ...
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">"app_name"</span><span class="nt">&gt;</span>Challenge 1<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">"part_3"</span><span class="nt">&gt;</span>part 3: analysis_<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">"search_menu_title"</span><span class="nt">&gt;</span>Search<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">"status_bar_notification_info_overflow"</span><span class="nt">&gt;</span>999+<span class="nt">&lt;/string&gt;</span>
<span class="nt">&lt;/resources&gt;</span>
</pre></table></code></div></div><p>Opening up the native library in a disassembler or just simply run <code class="language-plaintext highlighter-rouge">strings</code> on the file, we can see part two of the flag: <code class="language-plaintext highlighter-rouge">_static_</code></p><p><img data-proofer-ignore data-src="/assets/img/h1702/1.2.png" alt="mobile-1" /></p><p>I tried putting all these together but it was not the flag. I then noticed some weird functions in the native lib.</p><p><img data-proofer-ignore data-src="/assets/img/h1702/1.3.png" alt="mobile-1" /></p><p>Grabbing the characters in the order of the functions on the left yeild <code class="language-plaintext highlighter-rouge">_and_cool}</code>. That’s probably the last part of the flag.</p><p>Putting all of these together, we get <code class="language-plaintext highlighter-rouge">flag{so_much_static_analysis_much_wow_and_cool}</code></p><h2 id="mobile-challenge-2">Mobile Challenge 2</h2><p><img data-proofer-ignore data-src="/assets/img/h1702/2.0.png" alt="mobile-2" /></p><p>Install the app and open it, we are presented with an interface like a lock</p><p><img data-proofer-ignore data-src="/assets/img/h1702/2.1.png" alt="mobile-2" /></p><p>Try to enter a password, and we can see some log from the app in logcat:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>06-30 22:57:14.849  2994  2994 D PinLock : Pin complete: 121111
06-30 22:57:14.849  2994  2994 D TEST    : 00000000B93BFEBB00000000000000001CA70C341CA70C341CA70C34A59CF28F
06-30 22:57:14.849  2994  2994 D PROBLEM : Unable to decrypt text
</pre></table></code></div></div><p>Let’s open the apk again in jadx and investigate. Note the <code class="language-plaintext highlighter-rouge">onComplete</code> method, it is called when the pin is finished:</p><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onComplete</span><span class="o">(</span><span class="nc">String</span> <span class="n">str</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="n">str2</span> <span class="o">=</span> <span class="nc">MainActivity</span><span class="o">.</span><span class="na">this</span><span class="o">.</span><span class="na">TAG</span><span class="o">;</span>
    <span class="nc">StringBuilder</span> <span class="n">stringBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">();</span>
    <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"Pin complete: "</span><span class="o">);</span>
    <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">str</span><span class="o">);</span>
    <span class="nc">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="n">str2</span><span class="o">,</span> <span class="n">stringBuilder</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
    <span class="n">str</span> <span class="o">=</span> <span class="nc">MainActivity</span><span class="o">.</span><span class="na">this</span><span class="o">.</span><span class="na">getKey</span><span class="o">(</span><span class="n">str</span><span class="o">);</span>
    <span class="nc">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="s">"TEST"</span><span class="o">,</span> <span class="nc">MainActivity</span><span class="o">.</span><span class="na">bytesToHex</span><span class="o">(</span><span class="n">str</span><span class="o">));</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="nc">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="s">"DECRYPTED"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">String</span><span class="o">(</span><span class="k">new</span> <span class="nc">SecretBox</span><span class="o">(</span><span class="n">str</span><span class="o">).</span><span class="na">decrypt</span><span class="o">(</span><span class="s">"aabbccddeeffgghhaabbccdd"</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(),</span> <span class="nc">MainActivity</span><span class="o">.</span><span class="na">this</span><span class="o">.</span><span class="na">cipherText</span><span class="o">),</span> <span class="nc">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">RuntimeException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="s">"PROBLEM"</span><span class="o">,</span> <span class="s">"Unable to decrypt text"</span><span class="o">);</span>
        <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>So the app work as following:</p><ul><li>Once the user finishes entering a pin, the <code class="language-plaintext highlighter-rouge">onComplete</code> method is called on the pin<li>The pin string goes through the function <code class="language-plaintext highlighter-rouge">getKey</code> in the native lib<li>The derived key is they used to decrypt the ciphertext with the nonce of <code class="language-plaintext highlighter-rouge">aabbccddeeffgghhaabbccdd</code>. The encryption is carried out using libsodium</ul><p>There are 2 approaches:</p><ul><li>Reverse engineering the encrpytion algorithm and solve for the password<li>Bruteforce ;) The key is only 6-digit long so that means 1M passwords in total.</ul><p>I then patched the smali code perform a bruteforce on all possible keys when the <code class="language-plaintext highlighter-rouge">onEmpty</code> event is triggered. Patched smali file <code class="language-plaintext highlighter-rouge">MainActivity$1.smali</code></p><pre><code class="language-smali">.method public onEmpty()V
    .locals 1

    invoke-virtual {p0}, Lcom/hackerone/mobile/challenge2/MainActivity$1;-&gt;hack()V

    return-void
.end method

.method public hack()V
    .locals 8

    .prologue
    .line 15
    const/4 v0, 0x0

    move v1, v0

    :goto_2
    const v0, 0xf4240

    if-ge v1, v0, :cond_2f

    .line 16
    invoke-static {v1}, Ljava/lang/Integer;-&gt;toString(I)Ljava/lang/String;

    move-result-object v0

    .line 17
    :goto_b
    invoke-virtual {v0}, Ljava/lang/String;-&gt;length()I

    move-result v2

    const/4 v3, 0x6

    if-ge v2, v3, :cond_26

    .line 18
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-&gt;&lt;init&gt;()V

    const-string v3, "0"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;-&gt;append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;-&gt;append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/StringBuilder;-&gt;toString()Ljava/lang/String;

    move-result-object v0

    goto :goto_b

    .line 20
    :cond_26

    const-string v4, "TRYING"

    invoke-static {v4, v0}, Landroid/util/Log;-&gt;d(Ljava/lang/String;Ljava/lang/String;)I

    iget-object v4, p0, Lcom/hackerone/mobile/challenge2/MainActivity$1;-&gt;this$0:Lcom/hackerone/mobile/challenge2/MainActivity;

    invoke-virtual {v4, v0}, Lcom/hackerone/mobile/challenge2/MainActivity;-&gt;getKey(Ljava/lang/String;)[B

    move-result-object v0

    new-instance v4, Lorg/libsodium/jni/crypto/SecretBox;

    invoke-direct {v4, v0}, Lorg/libsodium/jni/crypto/SecretBox;-&gt;&lt;init&gt;([B)V

    const-string v5, "aabbccddeeffgghhaabbccdd"
    invoke-virtual {v5}, Ljava/lang/String;-&gt;getBytes()[B

    move-result-object v5


    :try_start_0
    iget-object v6, p0, Lcom/hackerone/mobile/challenge2/MainActivity$1;-&gt;this$0:Lcom/hackerone/mobile/challenge2/MainActivity;

    invoke-static {v6}, Lcom/hackerone/mobile/challenge2/MainActivity;-&gt;access$000(Lcom/hackerone/mobile/challenge2/MainActivity;)[B

    move-result-object v6

    invoke-virtual {v4, v5, v6}, Lorg/libsodium/jni/crypto/SecretBox;-&gt;decrypt([B[B)[B

    move-result-object v6

    .line 44
    new-instance v5, Ljava/lang/String;

    sget-object v4, Ljava/nio/charset/StandardCharsets;-&gt;UTF_8:Ljava/nio/charset/Charset;

    invoke-direct {v5, v6, v4}, Ljava/lang/String;-&gt;&lt;init&gt;([BLjava/nio/charset/Charset;)V

    const-string v6, "DECRYPTED"

    .line 46
    invoke-static {v6, v5}, Landroid/util/Log;-&gt;d(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_0
    .catch Ljava/lang/RuntimeException; {:try_start_0 .. :try_end_0} :catch_0

    goto :cond_2f

    :catch_0
    move-exception v7

    const-string v5, "PROBLEM"

    const-string v4, "Unable to decrypt text"

    .line 48
    invoke-static {v5, v4}, Landroid/util/Log;-&gt;d(Ljava/lang/String;Ljava/lang/String;)I

    .line 49
    invoke-virtual {v7}, Ljava/lang/RuntimeException;-&gt;printStackTrace()V

    .line 15
    add-int/lit8 v0, v1, 0x1

    move v1, v0

    goto :goto_2

    .line 22
    :cond_2f
    return-void
.end method
</code></pre><p>The decompiled code after patching looks like this</p><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">C03091</span> <span class="kd">implements</span> <span class="nc">PinLockListener</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onEmpty</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">hack</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">hack</span><span class="o">()</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">1000000</span><span class="o">)</span> <span class="o">{</span>
                <span class="nc">String</span> <span class="n">num</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
                <span class="k">while</span> <span class="o">(</span><span class="n">num</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">num</span> <span class="o">=</span> <span class="s">"0"</span> <span class="o">+</span> <span class="n">num</span><span class="o">;</span>
                <span class="o">}</span>
                <span class="nc">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="s">"TRYING"</span><span class="o">,</span> <span class="n">num</span><span class="o">);</span>
                <span class="k">try</span> <span class="o">{</span>
                    <span class="nc">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="s">"DECRYPTED"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">String</span><span class="o">(</span><span class="k">new</span> <span class="nc">SecretBox</span><span class="o">(</span><span class="nc">MainActivity</span><span class="o">.</span><span class="na">this</span><span class="o">.</span><span class="na">getKey</span><span class="o">(</span><span class="n">num</span><span class="o">)).</span><span class="na">decrypt</span><span class="o">(</span><span class="s">"aabbccddeeffgghhaabbccdd"</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(),</span> <span class="nc">MainActivity</span><span class="o">.</span><span class="na">this</span><span class="o">.</span><span class="na">cipherText</span><span class="o">),</span> <span class="nc">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>
                    <span class="k">return</span><span class="o">;</span>
                <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">RuntimeException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                    <span class="nc">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="s">"PROBLEM"</span><span class="o">,</span> <span class="s">"Unable to decrypt text"</span><span class="o">);</span>
                    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
                    <span class="n">i</span><span class="o">++;</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
<span class="o">...</span>
</pre></table></code></div></div><p>I then ran the patched APK and waiting for the bruteforce to finished, not noticed that there is a rate limit on the native <code class="language-plaintext highlighter-rouge">getKey</code> function. It was only performing about 50 tries every 10 seconds. I decided to investigate the native library to find out the rate limit.</p><p>I did not really understand all the functions in the library, and decided to replace numerical values where it appeared to see if the rate limit is changed. After some trials and errors, I finally figured out that the rate limit was carried out in the <code class="language-plaintext highlighter-rouge">Java_com_hackerone_mobile_challenge2_MainActivity_getKey</code> function.</p><p><img data-proofer-ignore data-src="/assets/img/h1702/2.2.png" alt="mobile-2" /></p><p>Notice the numerical value in the <code class="language-plaintext highlighter-rouge">cmp</code> operation, which is 51. That explains the rate I observed before in the log. I did attempt to patch the timing but did not succeed. Patching this did change the rate limit.</p><p><img data-proofer-ignore data-src="/assets/img/h1702/2.3.png" alt="mobile-2" /></p><p>Note that there are more bytes occupied by the 2 instructions (the <code class="language-plaintext highlighter-rouge">cmp</code> and the jump right after that) after patching than before patching. The bytes changed from <code class="language-plaintext highlighter-rouge">83 F8 33 72 64</code> to <code class="language-plaintext highlighter-rouge">3D 37 13 37 13 72 62</code>. Please also note that I am patching the x86 library while solving this challenge.</p><p>After running for a while, the bruteforce will stop when it finds the correct pin:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>06-30 23:58:42.117  5134  5134 W System.err:    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:858)
06-30 23:58:42.117  5134  5134 D TRYING  : 918264
06-30 23:58:42.117  5134  5134 D DECRYPTED: flag{wow_yall_called_a_lot_of_func$}
</pre></table></code></div></div><p>The correct pin is <code class="language-plaintext highlighter-rouge">918264</code> and the flag is <code class="language-plaintext highlighter-rouge">flag{wow_yall_called_a_lot_of_func$}</code></p><h2 id="mobile-challenge-3">Mobile Challenge 3</h2><p><img data-proofer-ignore data-src="/assets/img/h1702/3.0.png" alt="mobile-3" /></p><p>In this challenge, we are given a base.odex file and a boot.oat file. Basically, odex stands for optimized-dex, which is byte codes optimized for a specific device. To be able to obtain the dex file, we need to deodex the file. A tool that I found doing this job is baksmali. I ran the tool on the files but it was not successful. It was missing references to some methods.</p><div class="language-zsh highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>➜  chal3 git:<span class="o">(</span>master<span class="o">)</span> ✗ java <span class="nt">-Xmx512m</span> <span class="nt">-jar</span> baksmali.jar x base.odex <span class="nt">-c</span> boot.oat <span class="nt">-o</span> test_out                                         
org.jf.dexlib2.analysis.AnalysisException: Could not resolve the method <span class="k">in </span>class Landroid/support/v7/widget/MenuPopupWindow<span class="nv">$MenuDropDownListView</span><span class="p">;</span> at index 1053
	at org.jf.dexlib2.analysis.MethodAnalyzer.analyzeInvokeVirtualQuick<span class="o">(</span>MethodAnalyzer.java:1824<span class="o">)</span>
	at org.jf.dexlib2.analysis.MethodAnalyzer.analyzeInstruction<span class="o">(</span>MethodAnalyzer.java:1040<span class="o">)</span>
	at org.jf.dexlib2.analysis.MethodAnalyzer.analyze<span class="o">(</span>MethodAnalyzer.java:201<span class="o">)</span>
	at org.jf.dexlib2.analysis.MethodAnalyzer.&lt;init&gt;<span class="o">(</span>MethodAnalyzer.java:131<span class="o">)</span>
	at org.jf.baksmali.Adaptors.MethodDefinition.addAnalyzedInstructionMethodItems<span class="o">(</span>MethodDefinition.java:464<span class="o">)</span>
	at org.jf.baksmali.Adaptors.MethodDefinition.getMethodItems<span class="o">(</span>MethodDefinition.java:371<span class="o">)</span>
	at org.jf.baksmali.Adaptors.MethodDefinition.writeTo<span class="o">(</span>MethodDefinition.java:238<span class="o">)</span>
	at org.jf.baksmali.Adaptors.ClassDefinition.writeVirtualMethods<span class="o">(</span>ClassDefinition.java:326<span class="o">)</span>
	at org.jf.baksmali.Adaptors.ClassDefinition.writeTo<span class="o">(</span>ClassDefinition.java:112<span class="o">)</span>
	at org.jf.baksmali.Baksmali.disassembleClass<span class="o">(</span>Baksmali.java:152<span class="o">)</span>
	at org.jf.baksmali.Baksmali.access<span class="nv">$000</span><span class="o">(</span>Baksmali.java:46<span class="o">)</span>
	at org.jf.baksmali.Baksmali<span class="nv">$1</span>.call<span class="o">(</span>Baksmali.java:76<span class="o">)</span>
	at org.jf.baksmali.Baksmali<span class="nv">$1</span>.call<span class="o">(</span>Baksmali.java:74<span class="o">)</span>
	at java.util.concurrent.FutureTask.run<span class="o">(</span>FutureTask.java:266<span class="o">)</span>
	at java.util.concurrent.ThreadPoolExecutor.runWorker<span class="o">(</span>ThreadPoolExecutor.java:1149<span class="o">)</span>
	at java.util.concurrent.ThreadPoolExecutor<span class="nv">$Worker</span>.run<span class="o">(</span>ThreadPoolExecutor.java:624<span class="o">)</span>
	at java.lang.Thread.run<span class="o">(</span>Thread.java:748<span class="o">)</span>
opcode: invoke-virtual-quick
code address: 5
method: Landroid/support/v7/widget/MenuPopupWindow<span class="p">;</span>-&gt;createDropDownListView<span class="o">(</span>Landroid/content/Context<span class="p">;</span>Z<span class="o">)</span>Landroid/support/v7/widget/DropDownListView<span class="p">;</span>
</pre></table></code></div></div><p>After many trials and errors, and realized that the methods are from the android SDK, I copied the <code class="language-plaintext highlighter-rouge">android</code> folder from one of the previous challenges and use it with baksmali to deodex the file, hoping that it would work, and it did. I was able to pull out the main logic from the application and that was really fortunate.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nb">mkdir </span>framework
<span class="nb">mv </span>android framework <span class="c"># This is the android folder when you use apktool to unpack the apk from previous challenges</span>
java <span class="nt">-jar</span> smali.jar ass <span class="nt">-o</span> framework.dex framework
java <span class="nt">-Xmx512m</span> <span class="nt">-jar</span> baksmali.jar x <span class="nt">-c</span> framework.dex base.odex <span class="nt">-o</span> chal3
java <span class="nt">-jar</span> ../smali.jar ass chal3 <span class="nt">-o</span> chal3.dex
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
</pre><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">com.hackerone.mobile.challenge3</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">android.os.Bundle</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.support.v7.app.AppCompatActivity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.text.Editable</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.text.TextWatcher</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.widget.EditText</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainActivity</span> <span class="kd">extends</span> <span class="nc">AppCompatActivity</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">char</span><span class="o">[]</span> <span class="n">key</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="o">[]{</span><span class="sc">'t'</span><span class="o">,</span> <span class="sc">'h'</span><span class="o">,</span> <span class="sc">'i'</span><span class="o">,</span> <span class="sc">'s'</span><span class="o">,</span> <span class="sc">'_'</span><span class="o">,</span> <span class="sc">'i'</span><span class="o">,</span> <span class="sc">'s'</span><span class="o">,</span> <span class="sc">'_'</span><span class="o">,</span> <span class="sc">'a'</span><span class="o">,</span> <span class="sc">'_'</span><span class="o">,</span> <span class="sc">'k'</span><span class="o">,</span> <span class="sc">'3'</span><span class="o">,</span> <span class="sc">'y'</span><span class="o">};</span>
    <span class="kd">private</span> <span class="nc">EditText</span> <span class="n">editText</span><span class="o">;</span>

    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="nc">Bundle</span> <span class="n">bundle</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">bundle</span><span class="o">);</span>
        <span class="n">setContentView</span><span class="o">((</span><span class="kt">int</span><span class="o">)</span> <span class="no">C0225R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_main</span><span class="o">);</span>
        <span class="kd">final</span> <span class="nc">EditText</span> <span class="n">editText</span> <span class="o">=</span> <span class="o">(</span><span class="nc">EditText</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="no">C0225R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">editText</span><span class="o">);</span>
        <span class="n">editText</span><span class="o">.</span><span class="na">addTextChangedListener</span><span class="o">(</span><span class="k">new</span> <span class="nc">TextWatcher</span><span class="o">()</span> <span class="o">{</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">afterTextChanged</span><span class="o">(</span><span class="nc">Editable</span> <span class="n">editable</span><span class="o">)</span> <span class="o">{</span>
            <span class="o">}</span>

            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">beforeTextChanged</span><span class="o">(</span><span class="nc">CharSequence</span> <span class="n">charSequence</span><span class="o">,</span> <span class="kt">int</span> <span class="n">i</span><span class="o">,</span> <span class="kt">int</span> <span class="n">i2</span><span class="o">,</span> <span class="kt">int</span> <span class="n">i3</span><span class="o">)</span> <span class="o">{</span>
            <span class="o">}</span>

            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onTextChanged</span><span class="o">(</span><span class="nc">CharSequence</span> <span class="n">charSequence</span><span class="o">,</span> <span class="kt">int</span> <span class="n">i</span><span class="o">,</span> <span class="kt">int</span> <span class="n">i2</span><span class="o">,</span> <span class="kt">int</span> <span class="n">i3</span><span class="o">)</span> <span class="o">{</span>
                <span class="nc">MainActivity</span><span class="o">.</span><span class="na">checkFlag</span><span class="o">(</span><span class="n">editText</span><span class="o">.</span><span class="na">getText</span><span class="o">().</span><span class="na">toString</span><span class="o">());</span>
            <span class="o">}</span>
        <span class="o">});</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">hexStringToByteArray</span><span class="o">(</span><span class="nc">String</span> <span class="n">str</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">length</span> <span class="o">=</span> <span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">();</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">bArr</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[(</span><span class="n">length</span> <span class="o">/</span> <span class="mi">2</span><span class="o">)];</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="o">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">bArr</span><span class="o">[</span><span class="n">i</span> <span class="o">/</span> <span class="mi">2</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">((</span><span class="nc">Character</span><span class="o">.</span><span class="na">digit</span><span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">i</span><span class="o">),</span> <span class="mi">16</span><span class="o">)</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="o">)</span> <span class="o">+</span> <span class="nc">Character</span><span class="o">.</span><span class="na">digit</span><span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">),</span> <span class="mi">16</span><span class="o">));</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">bArr</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">checkFlag</span><span class="o">(</span><span class="nc">String</span> <span class="n">str</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="nc">String</span> <span class="n">str2</span> <span class="o">=</span> <span class="s">"flag{"</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">((</span><span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&gt;</span> <span class="n">str2</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">str</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">str2</span><span class="o">.</span><span class="na">length</span><span class="o">()).</span><span class="na">equals</span><span class="o">(</span><span class="n">str2</span><span class="o">))</span> <span class="o">||</span> <span class="n">str</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span> <span class="o">!=</span> <span class="sc">'}'</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="nc">String</span> <span class="n">encryptDecrypt</span> <span class="o">=</span> <span class="n">encryptDecrypt</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">hexStringToByteArray</span><span class="o">(</span><span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">(</span><span class="s">"kO13t41Oc1b2z4F5F1b2BO33c2d1c61OzOdOtO"</span><span class="o">).</span><span class="na">reverse</span><span class="o">().</span><span class="na">toString</span><span class="o">().</span><span class="na">replace</span><span class="o">(</span><span class="s">"O"</span><span class="o">,</span> <span class="s">"0"</span><span class="o">).</span><span class="na">replace</span><span class="o">(</span><span class="s">"t"</span><span class="o">,</span> <span class="s">"7"</span><span class="o">).</span><span class="na">replace</span><span class="o">(</span><span class="s">"B"</span><span class="o">,</span> <span class="s">"8"</span><span class="o">).</span><span class="na">replace</span><span class="o">(</span><span class="s">"z"</span><span class="o">,</span> <span class="s">"a"</span><span class="o">).</span><span class="na">replace</span><span class="o">(</span><span class="s">"F"</span><span class="o">,</span> <span class="s">"f"</span><span class="o">).</span><span class="na">replace</span><span class="o">(</span><span class="s">"k"</span><span class="o">,</span> <span class="s">"e"</span><span class="o">)));</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">||</span> <span class="n">str</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">str2</span><span class="o">.</span><span class="na">length</span><span class="o">(),</span> <span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">).</span><span class="na">equals</span><span class="o">(</span><span class="n">encryptDecrypt</span><span class="o">)</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">encryptDecrypt</span><span class="o">(</span><span class="kt">char</span><span class="o">[]</span> <span class="n">cArr</span><span class="o">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">bArr</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">StringBuilder</span> <span class="n">stringBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">bArr</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">((</span><span class="kt">char</span><span class="o">)</span> <span class="o">(</span><span class="n">bArr</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">^</span> <span class="n">cArr</span><span class="o">[</span><span class="n">i</span> <span class="o">%</span> <span class="n">cArr</span><span class="o">.</span><span class="na">length</span><span class="o">]));</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">stringBuilder</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>The logic is pretty straightforward. I wrote a python script to solve the challenge.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">key</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">t</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">h</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">i</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">s</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">_</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">i</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">s</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">_</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">_</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">3</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">y</span><span class="sh">'</span><span class="p">]</span>
    <span class="n">key</span> <span class="o">=</span> <span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">print</span> <span class="sh">"</span><span class="s">key = {}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="sh">"</span><span class="s">kO13t41Oc1b2z4F5F1b2BO33c2d1c61OzOdOtO</span><span class="sh">"</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="sh">"</span><span class="s">O</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">0</span><span class="sh">"</span><span class="p">).</span><span class="nf">replace</span><span class="p">(</span><span class="sh">"</span><span class="s">t</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">7</span><span class="sh">"</span><span class="p">).</span><span class="nf">replace</span><span class="p">(</span><span class="sh">"</span><span class="s">B</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">8</span><span class="sh">"</span><span class="p">).</span><span class="nf">replace</span><span class="p">(</span><span class="sh">"</span><span class="s">z</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">a</span><span class="sh">"</span><span class="p">).</span><span class="nf">replace</span><span class="p">(</span><span class="sh">"</span><span class="s">F</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">f</span><span class="sh">"</span><span class="p">).</span><span class="nf">replace</span><span class="p">(</span><span class="sh">"</span><span class="s">k</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">e</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">print</span> <span class="sh">"</span><span class="s">s = {}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">decode</span><span class="p">(</span><span class="sh">'</span><span class="s">hex</span><span class="sh">'</span><span class="p">)</span>
    <span class="k">print</span> <span class="sh">"</span><span class="s">hex decoded s = {}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">key</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)[:</span><span class="nf">len</span><span class="p">(</span><span class="n">s</span><span class="p">)]</span>
    <span class="k">print</span> <span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">([</span><span class="nf">chr</span><span class="p">(</span><span class="nf">ord</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">^</span> <span class="nf">ord</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">key</span><span class="p">)])</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>

</pre></table></code></div></div><p>The flag is <code class="language-plaintext highlighter-rouge">flag{secr3t_littl3_th4ng}</code>.</p><h2 id="mobile-challenge-4">Mobile Challenge 4</h2><p>This is probably my favorite one because I learned so much more in this challenge, from writing my first android app to learning about vulnerabilities that an application can introduce.</p><p>At first, I didn’t know where to start because I have not tried to pwn an apk application before. Looking at tools to scan for vulnerabilities in APKs, I found QARK, a pretty neat tool from LinkedIn that can be used to quickly scan for common vulnerabilities in an android application, using mostly static analysis.</p><p>At the same time, I read the setup instruction and kinda had a sense of what I have to do:</p><ul><li>The flag file is at <code class="language-plaintext highlighter-rouge">/data/local/tmp/challenge4</code><li>The owner of the file is root, the owner group is the same group as the vulnerable application.</ul><p>Since we have to exploit the application, my guess was that we need to somehow use the vulnerable app’s permission to read the flag file. When the scan from QARK finish, I skimmed through the report and noticed this</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>INFO - Be careful with use of Check permission function
App maybe vulnerable to Privilege escalation or Confused Deputy Attack. This function can grant access to malicious application, lacking the appropriate permission, by assuming your applications permissions. This means a malicious application, without appropriate permissions, can bypass its permission check by using your applicationpermission to get access to otherwise denied resources. Use - checkCallingPermission instead.
Filepath: /home/me/Desktop/challenge4_release/classes_dex2jar/android/support/v4/app/NotificationCompatSideChannelService.java
Reference: https://developer.android.com/reference/android/content/Context.html#checkCallingOrSelfPermission(java.lang.String)
</pre></table></code></div></div><p>And also this</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre><td class="rouge-code"><pre>==&gt;EXPORTED ACTIVITIES: 
0: com.hackerone.mobile.challenge4.MenuActivity
INFO - Checking for extras in this file: com.hackerone.mobile.challenge4.MenuActivity from this entry point: onCreate
ERROR - Could not create a tree to find extras in : /home/me/Desktop/challenge4_release/classes_dex2jar/com/hackerone/mobile/challenge4/MenuActivity.java
INFO - Attempting fall-back method to determine extras
INFO - Checking for extras in this file: com.hackerone.mobile.challenge4.MenuActivity from this entry point: onStart
ERROR - Could not create a tree to find extras in : /home/me/Desktop/challenge4_release/classes_dex2jar/com/hackerone/mobile/challenge4/MenuActivity.java
INFO - Attempting fall-back method to determine extras
adb shell am start -a "android.intent.action.MAIN" -n "com.hackerone.mobile.challenge4/com.hackerone.mobile.challenge4.MenuActivity"
==&gt;EXPORTED RECEIVERS: 
0: com.hackerone.mobile.challenge4.MazeMover
INFO - Checking for extras in this file: com.hackerone.mobile.challenge4.MazeMover from this entry point: onReceive
INFO - Possible Extra: localObject of unknown type
INFO - Possible Extra: "cereal" of type: Serializable
INFO - Extra: localObject is not a simple type, or could not be determined. You'll need to append the parameter which corresponds with the correct data type, followed by a key and value, both in quotes.
Example: adb shell am broadcast -a "com.hackerone.mobile.challenge4.broadcast.MAZE_MOVER" --es "YOURKEYHERE" "YOURVALUEHERE"
Here are your options for different data types: 
[-e|--es &lt;EXTRA_KEY&gt; &lt;EXTRA_STRING_VALUE&gt; ...]
[--esn &lt;EXTRA_KEY&gt; ...]
[--ez &lt;EXTRA_KEY&gt; &lt;EXTRA_BOOLEAN_VALUE&gt; ...]
[--ei &lt;EXTRA_KEY&gt; &lt;EXTRA_INT_VALUE&gt; ...]
[--el &lt;EXTRA_KEY&gt; &lt;EXTRA_LONG_VALUE&gt; ...]
[--ef &lt;EXTRA_KEY&gt; &lt;EXTRA_FLOAT_VALUE&gt; ...]
[--eu &lt;EXTRA_KEY&gt; &lt;EXTRA_URI_VALUE&gt; ...]
[--ecn &lt;EXTRA_KEY&gt; &lt;EXTRA_COMPONENT_NAME_VALUE&gt;]
[--eia &lt;EXTRA_KEY&gt; &lt;EXTRA_INT_VALUE&gt;[,&lt;EXTRA_INT_VALUE...]]
[--ela &lt;EXTRA_KEY&gt; &lt;EXTRA_LONG_VALUE&gt;[,&lt;EXTRA_LONG_VALUE...]]
[--efa &lt;EXTRA_KEY&gt; &lt;EXTRA_FLOAT_VALUE&gt;[,&lt;EXTRA_FLOAT_VALUE...]]
[--esa &lt;EXTRA_KEY&gt; &lt;EXTRA_STRING_VALUE&gt;[,&lt;EXTRA_STRING_VALUE...]]


INFO - Extra: "cereal" is not a simple type, or could not be determined. You'll need to append the parameter which corresponds with the correct data type, followed by a key and value, both in quotes.
Example: adb shell am broadcast -a "com.hackerone.mobile.challenge4.broadcast.MAZE_MOVER" --es "YOURKEYHERE" "YOURVALUEHERE"
Here are your options for different data types: 
[-e|--es &lt;EXTRA_KEY&gt; &lt;EXTRA_STRING_VALUE&gt; ...]
[--esn &lt;EXTRA_KEY&gt; ...]
[--ez &lt;EXTRA_KEY&gt; &lt;EXTRA_BOOLEAN_VALUE&gt; ...]
[--ei &lt;EXTRA_KEY&gt; &lt;EXTRA_INT_VALUE&gt; ...]
[--el &lt;EXTRA_KEY&gt; &lt;EXTRA_LONG_VALUE&gt; ...]
[--ef &lt;EXTRA_KEY&gt; &lt;EXTRA_FLOAT_VALUE&gt; ...]
[--eu &lt;EXTRA_KEY&gt; &lt;EXTRA_URI_VALUE&gt; ...]
[--ecn &lt;EXTRA_KEY&gt; &lt;EXTRA_COMPONENT_NAME_VALUE&gt;]
[--eia &lt;EXTRA_KEY&gt; &lt;EXTRA_INT_VALUE&gt;[,&lt;EXTRA_INT_VALUE...]]
[--ela &lt;EXTRA_KEY&gt; &lt;EXTRA_LONG_VALUE&gt;[,&lt;EXTRA_L..m,mmONG_VALUE...]]
[--efa &lt;EXTRA_KEY&gt; &lt;EXTRA_FLOAT_VALUE&gt;[,&lt;EXTRA_FLOAT_VALUE...]]
[--esa &lt;EXTRA_KEY&gt; &lt;EXTRA_STRING_VALUE&gt;[,&lt;EXTRA_STRING_VALUE...]]
</pre></table></code></div></div><p>I did not know what this was at that moment. However, it seemed interesting because of the keywords like <code class="language-plaintext highlighter-rouge">cereal</code> and also serializable objects, which I heard of vulnerabilities related to this but in PHP. Let’s open the app in jadx to investigate the sauce!</p><p>I opened up the class <code class="language-plaintext highlighter-rouge">MazeMover</code> in the report and the code was quite interesting:</p><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MazeMover</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">onReceive</span><span class="o">(</span><span class="nc">Context</span> <span class="n">context</span><span class="o">,</span> <span class="nc">Intent</span> <span class="n">intent</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="nc">MainActivity</span><span class="o">.</span><span class="na">getMazeView</span><span class="o">()</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">Log</span><span class="o">.</span><span class="na">i</span><span class="o">(</span><span class="s">"MazeMover"</span><span class="o">,</span> <span class="s">"Not currently trying to solve the maze"</span><span class="o">);</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="nc">GameManager</span> <span class="n">gameManager</span> <span class="o">=</span> <span class="nc">MainActivity</span><span class="o">.</span><span class="na">getMazeView</span><span class="o">().</span><span class="na">getGameManager</span><span class="o">();</span>
        <span class="nc">Bundle</span> <span class="n">extras</span> <span class="o">=</span> <span class="n">intent</span><span class="o">.</span><span class="na">getExtras</span><span class="o">();</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">extras</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">intent</span><span class="o">.</span><span class="na">hasExtra</span><span class="o">(</span><span class="s">"get_maze"</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Intent</span><span class="o">();</span>
                <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="s">"walls"</span><span class="o">,</span> <span class="n">gameManager</span><span class="o">.</span><span class="na">getMaze</span><span class="o">().</span><span class="na">getWalls</span><span class="o">());</span>
                <span class="nc">Serializable</span> <span class="n">arrayList</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">();</span>
                <span class="n">arrayList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="nc">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">gameManager</span><span class="o">.</span><span class="na">getPlayer</span><span class="o">().</span><span class="na">getX</span><span class="o">()));</span>
                <span class="n">arrayList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="nc">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">gameManager</span><span class="o">.</span><span class="na">getPlayer</span><span class="o">().</span><span class="na">getY</span><span class="o">()));</span>
                <span class="n">arrayList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="nc">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">gameManager</span><span class="o">.</span><span class="na">getExit</span><span class="o">().</span><span class="na">getX</span><span class="o">()));</span>
                <span class="n">arrayList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="nc">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">gameManager</span><span class="o">.</span><span class="na">getExit</span><span class="o">().</span><span class="na">getY</span><span class="o">()));</span>
                <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="s">"positions"</span><span class="o">,</span> <span class="n">arrayList</span><span class="o">);</span>
                <span class="n">intent</span><span class="o">.</span><span class="na">setAction</span><span class="o">(</span><span class="s">"com.hackerone.mobile.challenge4.broadcast.MAZE_MOVER"</span><span class="o">);</span>
                <span class="n">context</span><span class="o">.</span><span class="na">sendBroadcast</span><span class="o">(</span><span class="n">intent</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">intent</span><span class="o">.</span><span class="na">hasExtra</span><span class="o">(</span><span class="s">"move"</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">intent</span> <span class="o">=</span> <span class="n">extras</span><span class="o">.</span><span class="na">getChar</span><span class="o">(</span><span class="s">"move"</span><span class="o">);</span>
                <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
                <span class="kt">int</span> <span class="n">i2</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
                <span class="k">switch</span> <span class="o">(</span><span class="n">intent</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">case</span> <span class="mi">104</span><span class="o">:</span>
                        <span class="n">i2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
                        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
                        <span class="k">break</span><span class="o">;</span>
                    <span class="k">case</span> <span class="mi">106</span><span class="o">:</span>
                        <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
                        <span class="k">break</span><span class="o">;</span>
                    <span class="k">case</span> <span class="mi">107</span><span class="o">:</span>
                        <span class="k">break</span><span class="o">;</span>
                    <span class="k">case</span> <span class="mi">108</span><span class="o">:</span>
                        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
                        <span class="n">i2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
                        <span class="k">break</span><span class="o">;</span>
                    <span class="k">default</span><span class="o">:</span>
                        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
                        <span class="k">break</span><span class="o">;</span>
                <span class="o">}</span>
                <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Point</span><span class="o">(</span><span class="n">i2</span><span class="o">,</span> <span class="n">i</span><span class="o">);</span>
                <span class="nc">Intent</span> <span class="n">intent2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Intent</span><span class="o">();</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">gameManager</span><span class="o">.</span><span class="na">movePlayer</span><span class="o">(</span><span class="n">intent</span><span class="o">)</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">intent2</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="s">"move_result"</span><span class="o">,</span> <span class="s">"good"</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="n">intent2</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="s">"move_result"</span><span class="o">,</span> <span class="s">"bad"</span><span class="o">);</span>
                <span class="o">}</span>
                <span class="n">intent2</span><span class="o">.</span><span class="na">setAction</span><span class="o">(</span><span class="s">"com.hackerone.mobile.challenge4.broadcast.MAZE_MOVER"</span><span class="o">);</span>
                <span class="n">context</span><span class="o">.</span><span class="na">sendBroadcast</span><span class="o">(</span><span class="n">intent2</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">intent</span><span class="o">.</span><span class="na">hasExtra</span><span class="o">(</span><span class="s">"cereal"</span><span class="o">))</span> <span class="o">{</span>
                <span class="o">((</span><span class="nc">GameState</span><span class="o">)</span> <span class="n">intent</span><span class="o">.</span><span class="na">getSerializableExtra</span><span class="o">(</span><span class="s">"cereal"</span><span class="o">)).</span><span class="na">initialize</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>I would like to quickly explain some of the concepts that I’ve learned during the proccess of understanding this piece of code. There may be incorrect details because this is my first time attempting to do mobile hacking. I would appreciate any comments that would correct me.</p><p>Firstly, the way android applications are able to interact with each other is by broadcasting and listening for messages. Such messages are called <em>Intents</em>. Each intent needs to indicate an action that it wants to carry out, and there may be parameters to this actions. These parameters are called <em>extras</em>. Extras can be of many types, from String, Integer to Serializable objects.</p><p>Secondly, an app by declaring a broadcast receiver is able to listen to intents, and by declaring the intent filters, it can determine if the receiver will be processing the intent or not, based on the action in the intent.</p><p>Going back to the piece of code above, what it does is defining an event handler when an intent is received.</p><ul><li>If an intent with an extra key <code class="language-plaintext highlighter-rouge">get_maze</code> is received, broadcast an intent with the information of the current maze view including the positions of the player and the exit, the walls positions<li>If an intent with an extra key <code class="language-plaintext highlighter-rouge">move</code> is received, get the move value as a character and attempt to move the player accordingly, then broadcast the result of the move<li>If an intent with an extra key <code class="language-plaintext highlighter-rouge">cereal</code> is received, get the serializable object in the value, cast it to <code class="language-plaintext highlighter-rouge">GameState</code> type and then call the <code class="language-plaintext highlighter-rouge">initialize</code> method on the current context</ul><p>After understanding intents and stuffs, I found out another broadcast receiver was declared in the MenuActivity to start the game.</p><p>With the knowledge of all the broadcast receivers, we know that we can interact with the game play and also execute codes in the applicatioin by passing a serializable object to the intent. The code execution, however, is really limited, but I was determined that this is the way to get the flag and decided to investigate the code paths leading to and from the <code class="language-plaintext highlighter-rouge">cereal</code> intent extra.</p><p>Let’s investigate the code of the <code class="language-plaintext highlighter-rouge">GameState</code> class:</p><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">com.hackerone.mobile.challenge4</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">android.content.Context</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.util.Log</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GameState</span> <span class="kd">implements</span> <span class="nc">Serializable</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="n">cleanupTag</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Context</span> <span class="n">context</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="n">levelsCompleted</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="n">playerX</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="n">playerY</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kt">long</span> <span class="n">seed</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nc">StateController</span> <span class="n">stateController</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">GameState</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">,</span> <span class="kt">int</span> <span class="n">i2</span><span class="o">,</span> <span class="kt">long</span> <span class="n">j</span><span class="o">,</span> <span class="kt">int</span> <span class="n">i3</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">playerX</span> <span class="o">=</span> <span class="n">i</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">playerY</span> <span class="o">=</span> <span class="n">i2</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">seed</span> <span class="o">=</span> <span class="n">j</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">levelsCompleted</span> <span class="o">=</span> <span class="n">i3</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nf">GameState</span><span class="o">(</span><span class="nc">String</span> <span class="n">str</span><span class="o">,</span> <span class="nc">StateController</span> <span class="n">stateController</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">cleanupTag</span> <span class="o">=</span> <span class="n">str</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">stateController</span> <span class="o">=</span> <span class="n">stateController</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="o">(</span><span class="nc">Context</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">context</span> <span class="o">=</span> <span class="n">context</span><span class="o">;</span>
        <span class="nc">GameState</span> <span class="n">gameState</span> <span class="o">=</span> <span class="o">(</span><span class="nc">GameState</span><span class="o">)</span> <span class="k">this</span><span class="o">.</span><span class="na">stateController</span><span class="o">.</span><span class="na">load</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">gameState</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">playerX</span> <span class="o">=</span> <span class="n">gameState</span><span class="o">.</span><span class="na">playerX</span><span class="o">;</span>
            <span class="k">this</span><span class="o">.</span><span class="na">playerY</span> <span class="o">=</span> <span class="n">gameState</span><span class="o">.</span><span class="na">playerY</span><span class="o">;</span>
            <span class="k">this</span><span class="o">.</span><span class="na">seed</span> <span class="o">=</span> <span class="n">gameState</span><span class="o">.</span><span class="na">seed</span><span class="o">;</span>
            <span class="k">this</span><span class="o">.</span><span class="na">levelsCompleted</span> <span class="o">=</span> <span class="n">gameState</span><span class="o">.</span><span class="na">levelsCompleted</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">finalize</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="s">"GameState"</span><span class="o">,</span> <span class="s">"Called finalize on GameState"</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="nc">GameManager</span><span class="o">.</span><span class="na">levelsCompleted</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="o">.</span><span class="na">context</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">stateController</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">context</span><span class="o">,</span> <span class="k">this</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>There are several interesting details here:</p><ul><li>Most of the fields are not interesting, except for the <code class="language-plaintext highlighter-rouge">stateController</code> one.<li>The <code class="language-plaintext highlighter-rouge">stateController</code> is used to call its method in the initialize function<li>There is a finialize method, in which the <code class="language-plaintext highlighter-rouge">stateController</code> is being used again after some conditions are satisfied:<ul><li>More than 2 levels are completed<li>The current context is not null</ul><li>There are 2 constructors of this class. In one of them, we can initialize the <code class="language-plaintext highlighter-rouge">stateController</code> field.</ul><p><em>I smell some more code execution</em></p><p>Keep investigating other classes, I found out that there are 2 subclasses extending the <code class="language-plaintext highlighter-rouge">StateController</code> class: <code class="language-plaintext highlighter-rouge">StateLoader</code> and <code class="language-plaintext highlighter-rouge">BroadcastAnnouncer</code>. At this point, I kinda have an idea in mind to test out the code execution by initialize a GameState instance with a StateController, in which the StateController is also initialized with some field that ressembles a file location. However, there are several differences between the 2 subclasses.</p><ul><li>In the <code class="language-plaintext highlighter-rouge">load</code> method, <code class="language-plaintext highlighter-rouge">StateLoader</code> uses the <code class="language-plaintext highlighter-rouge">location</code> field in the super class to open a file, and read an object from the file. The <code class="language-plaintext highlighter-rouge">BroadcastAnnouncer</code> also opens a file but reads in strings from that file. The string from the file is used to make HTTP requests in other methods in the class.<li>The <code class="language-plaintext highlighter-rouge">save</code> method in <code class="language-plaintext highlighter-rouge">StateLoader</code> write objects to file and it makes HTTP requests mentioned before in <code class="language-plaintext highlighter-rouge">BroadcastAnnoucner</code>. The destination of the HTTP requests and the file location are all user controllable.</ul><p>At this point, putting all we have together, we can plan out an exploit:</p><ul><li>Instantiate a BroadcastAnnouncer with the flag file location and a destination to a web server that we control. The reason for this is quite clear because the data type that <code class="language-plaintext highlighter-rouge">BroadcastAnnouncer</code> deals with is the same as it is in the flag file, which is string. <code class="language-plaintext highlighter-rouge">StateLoader</code>, however, deals with serializable objects.<li>Instantiate a GameState with the BroadcastAnnouncer above.<li>Send an intent to the vulnerable app with the <code class="language-plaintext highlighter-rouge">cereal</code> extra and the <code class="language-plaintext highlighter-rouge">GameState</code> object.<li>Somehow trigger the save method in the StateController.</ul><p>At the last step, going back to the <code class="language-plaintext highlighter-rouge">finalize</code> method in <code class="language-plaintext highlighter-rouge">GameState</code>, we can see that the <code class="language-plaintext highlighter-rouge">save</code> method is called here, but only after satisfying some conditions. But when is the <code class="language-plaintext highlighter-rouge">finalize</code> method being called?</p><p>I at that point did not notice the finalize method. I crafted the exploit, play some levels in the game and trigger the exploit. It was working inconsistently but it yeilded the flag! Later on, I did some search and figured out that the <code class="language-plaintext highlighter-rouge">finalize</code> method is called by the Garbage Collector of JVM, when there is no reference to the instance anymore. This is quite interesting, but that’s all I know. My guess for why it works is that when we sent the object in the intent, it was instantiated but not being used anywhere else in the code and got garbage collected eventually, triggering the <code class="language-plaintext highlighter-rouge">finalize</code> method.</p><p>Now the only problem is that we have to solve more than 2 levels to trigger the code path to the <code class="language-plaintext highlighter-rouge">save</code> method. We can interact with the game, start it, move the player, get the maze state. A simple algorithm that would solve the maze is Depth-First Search.</p><p>The source code of my exploit app can be found <a href="https://github.com/ducphanduyagentp/h1702-ctf/blob/master/Challenge4_exploit">here</a>. I would like to explain some of the stuffs that I did in the exploit.</p><p>While I was playing with broadcasting intents, from the adb shell or from an APK, I encounter this warning <code class="language-plaintext highlighter-rouge">BroadcastQueue: Background execution not allowed: receiving Intent...</code>, which did not call the <code class="language-plaintext highlighter-rouge">onReceive</code> handler and the code did not executed accordingly. This is due to the background process limitation starting from Android O. I found a blog post that describe the workaround <a href="https://commonsware.com/blog/2017/04/11/android-o-implicit-broadcast-ban.html">here</a></p><p>Basically, to work around this, I both had to register a receiver in my MainActivity and define the <code class="language-plaintext highlighter-rouge">targetSdkVersion</code> of 25. I am still not sure if that totally solves the problem or not because broadcasting intents still doesn’t work sometimes, but it was a lot better than before.</p><p>This problem and also the asynchronous broadcasts is why I had to delay the broadcasts sending from my application. It’s kinda a workaround so that codes can run synchronously as intended. If you have any questions about my code, please feel free to leave a comments or hit me up on any of my social networks. I am willing to discuss the matters with you. The code at the time of writing this blog is still messy, I will try to clean it up asap!</p><p>After tweaking the exploit several times, I sent the APK to @breadchris. It was night time at my place so I went to bed. The next day, my exploit was run and I couldn’t be happier when I saw the flag in my web server log.</p><p><img data-proofer-ignore data-src="/assets/img/h1702/4.1.png" alt="mobile-4" /></p><p>pwned! The flag is <code class="language-plaintext highlighter-rouge">flag{my_favorite_cereal_and_mazes}</code>.</p><p><strong>Thanks for a great CTF <a href="https://twitter.com/Hacker0x01">@Hackerone</a>!</strong></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a>, <a href='/categories/mobile/'>mobile</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/mobile/" class="post-tag no-text-decoration" >mobile</a> <a href="/tags/android/" class="post-tag no-text-decoration" >android</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1"></span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=H1-702 CTF 2018 - ret2life&url=https://ret2.life/posts/H1-702-CTF-2018/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=H1-702 CTF 2018 - ret2life&u=https://ret2.life/posts/H1-702-CTF-2018/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=H1-702 CTF 2018 - ret2life&url=https://ret2.life/posts/H1-702-CTF-2018/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="" title-succeed=""> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Google-CTF-2021/">Google CTF 2021 - Fullchain</a><li><a href="/posts/CSAW-CTF-17-Qual/">CSAW CTF 2017 Qualification</a><li><a href="/posts/AceBear-CTF-19/">AceBear CTF 19</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/pwn/">pwn</a> <a class="post-tag" href="/tags/reversing/">reversing</a> <a class="post-tag" href="/tags/browser/">browser</a> <a class="post-tag" href="/tags/pentest/">pentest</a> <a class="post-tag" href="/tags/radare2/">radare2</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/blue-team/">blue team</a> <a class="post-tag" href="/tags/ccdc/">ccdc</a> <a class="post-tag" href="/tags/chrome/">chrome</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/SANS-HHC-2017/"><div class="card-body"> <span class="timeago small" >Dec 16, 2017<i class="unloaded">2017-12-16T22:42:59+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>2017 SANS Holiday Hacking Challenge</h3><div class="text-muted small"><p> This year, I’ve had the chance to participate in SANS Holiday Hacking Challenge. The first time I did it was last year. I didn’t think it was interesting with real pentesting stuffs until I read th...</p></div></div></a></div><div class="card"> <a href="/posts/GRIMM-HAX-Combined-Challenge/"><div class="card-body"> <span class="timeago small" >May 23, 2018<i class="unloaded">2018-05-23T03:08:38+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>GRIMM HAX Combined Challenge</h3><div class="text-muted small"><p> This is the write-up for challenges I have done GRIMM HAX challenge. Welcome, Bobby (100pts) Accessing the website at http://www.haxcorp.grimm-co.com/, we are provided with a login page with us...</p></div></div></a></div><div class="card"> <a href="/posts/35C3-CTF/"><div class="card-body"> <span class="timeago small" >Dec 30, 2018<i class="unloaded">2018-12-30T11:01:14+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>35C3 CTF</h3><div class="text-muted small"><p> This is my first time participating in C3 CTF. Although I wasn’t able to solve many challenges within the time of the CTF, I still find the challenges really awesome and exciting. I wanted to solve...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/GRIMM-HAX-Combined-Challenge/" class="btn btn-outline-primary" prompt="Older"><p>GRIMM HAX Combined Challenge</p></a> <a href="/posts/35C3-CTF/" class="btn btn-outline-primary" prompt="Newer"><p>35C3 CTF</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/username">Duc Phan</a>.</p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4"></h4><a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/pwn/">pwn</a> <a class="post-tag" href="/tags/reversing/">reversing</a> <a class="post-tag" href="/tags/browser/">browser</a> <a class="post-tag" href="/tags/pentest/">pentest</a> <a class="post-tag" href="/tags/radare2/">radare2</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/blue-team/">blue team</a> <a class="post-tag" href="/tags/ccdc/">ccdc</a> <a class="post-tag" href="/tags/chrome/">chrome</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-WN0BSTHR4X"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-WN0BSTHR4X'); }); </script>
